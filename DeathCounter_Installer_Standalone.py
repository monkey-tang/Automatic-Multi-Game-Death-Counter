"""
Death Counter - Single File Installer
This is a self-extracting installer that contains all necessary files.
"""

import os
import sys
import base64
import subprocess
import shutil
import tempfile
from pathlib import Path
import tkinter as tk
from tkinter import ttk, messagebox, scrolledtext
import threading
import urllib.request
import urllib.error
import webbrowser

# Embedded files (base64 encoded)
EMBEDDED_FILES = {
  "multi_game_death_counter.py": "IiIiCk11bHRpLUdhbWUgRGVhdGggQ291bnRlciBEYWVtb24KU3VwcG9ydHMgbXVsdGlwbGUgZ2FtZXMgd2l0aCBjb25maWd1cmFibGUgZGV0ZWN0aW9uIHJlZ2lvbnMgYW5kIGtleXdvcmRzLgpBdXRvbWF0aWNhbGx5IHRyYWNrcyBkZWF0aHMgYWNyb3NzIGRpZmZlcmVudCBnYW1lcy4KQXV0by1kZXRlY3RzIHdoaWNoIGdhbWUgaXMgcnVubmluZyBieSBjaGVja2luZyBwcm9jZXNzIG5hbWVzLgoKUmVxdWlyZW1lbnRzOgogICAgcGlwIGluc3RhbGwgbXNzIHBpbGxvdyBweXRlc3NlcmFjdCBvcGVuY3YtcHl0aG9uIG51bXB5IHBzdXRpbAoiIiIKCmltcG9ydCBvcwppbXBvcnQgdGltZQppbXBvcnQgY3R5cGVzCmltcG9ydCBqc29uCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHBzdXRpbApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgVHVwbGUsIE9wdGlvbmFsCgppbXBvcnQgY3YyCmltcG9ydCBudW1weSBhcyBucApmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKZnJvbSBtc3MgaW1wb3J0IG1zcwppbXBvcnQgcHl0ZXNzZXJhY3QKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PQojIENPTkZJR1VSQVRJT04KIyA9PT09PT09PT09PT09PT09PT09PT09PT09CkJBU0VfRElSID0gciJDOlwxZGVhdGhjb3VudGVyIgpDT05GSUdfRklMRSA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImdhbWVzX2NvbmZpZy5qc29uIikKTE9DS19GSUxFID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZGFlbW9uLmxvY2siKQpTVE9QX0ZJTEUgPSBvcy5wYXRoLmpvaW4oQkFTRV9ESVIsICJTVE9QIikKCkRFQlVHX1JBVyA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYnVnX2NhcHR1cmVfcmF3LnBuZyIpCkRFQlVHX09DUiA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYnVnX2NhcHR1cmUucG5nIikKREVCVUdfTE9HID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZGVidWcubG9nIikKCkRFQVRIX1RYVCA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYXRoX2NvdW50ZXIudHh0IikKU1RBVEVfSlNPTiA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYXRoX3N0YXRlLmpzb24iKQpDVVJSRU5UX0dBTUVfVFhUID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiY3VycmVudF9nYW1lLnR4dCIpICAjIEN1cnJlbnQgZ2FtZSBuYW1lIGZvciBTdHJlYW1lci5ib3QKQ1VSUkVOVF9ERUFUSFNfVFhUID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiY3VycmVudF9kZWF0aHMudHh0IikgICMgQ3VycmVudCBnYW1lIGRlYXRoIGNvdW50IGZvciBTdHJlYW1lci5ib3QKVE9UQUxfREVBVEhTX1RYVCA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgInRvdGFsX2RlYXRocy50eHQiKSAgIyBUb3RhbCBkZWF0aHMgYWNyb3NzIGFsbCBnYW1lcyBmb3IgU3RyZWFtZXIuYm90CgpURVNTRVJBQ1RfRVhFID0gciJDOlxQcm9ncmFtIEZpbGVzXFRlc3NlcmFjdC1PQ1JcdGVzc2VyYWN0LmV4ZSIKcHl0ZXNzZXJhY3QucHl0ZXNzZXJhY3QudGVzc2VyYWN0X2NtZCA9IFRFU1NFUkFDVF9FWEUKCiMgRGVmYXVsdCBzZXR0aW5ncwpERUZBVUxUX1NFVFRJTkdTID0gewogICAgInRpY2tfc2Vjb25kcyI6IDAuMzAsCiAgICAiZGVidWdfZXZlcnlfdGlja3MiOiAzMCwKICAgICJjb25zZWN1dGl2ZV9oaXRzIjogMiwKICAgICJjb29sZG93bl9zZWNvbmRzIjogOC4wLAogICAgIm1vbml0b3JfaW5kZXgiOiAxLCAgIyAxLWluZGV4ZWQgKG1vbml0b3IgMSBpcyBwcmltYXJ5KQp9CgojID09PT09PT09PT09PT09PT09PT09PT09PT0KIyBERUZBVUxUIEdBTUUgQ09ORklHUwojID09PT09PT09PT09PT09PT09PT09PT09PT0KREVGQVVMVF9HQU1FUyA9IHsKICAgICJFbGRlbiBSaW5nIjogewogICAgICAgICJyZWdpb24iOiB7ImxlZnQiOiA1MjAsICJ0b3AiOiA0NzAsICJ3aWR0aCI6IDg4MCwgImhlaWdodCI6IDIwMH0sCiAgICAgICAgImtleXdvcmRzIjogWyJZT1VESUVEIiwgIllPVURJRSIsICJESUVEIl0sCiAgICAgICAgInRlc3NlcmFjdF9jb25maWciOiAiLS1vZW0gMyAtLXBzbSA3IC1jIHRlc3NlZGl0X2NoYXJfd2hpdGVsaXN0PVlPVURJRUFERlQiLAogICAgICAgICJtb25pdG9yX2luZGV4IjogMiwKICAgICAgICAicHJvY2Vzc19uYW1lcyI6IFsiZWxkZW5yaW5nLmV4ZSIsICJlbGRlbiByaW5nLmV4ZSJdLCAgIyBQcm9jZXNzIG5hbWVzIHRvIGRldGVjdAogICAgfSwKICAgICJEYXJrIFNvdWxzIDMiOiB7CiAgICAgICAgInJlZ2lvbiI6IHsibGVmdCI6IDUyMCwgInRvcCI6IDQ3MCwgIndpZHRoIjogODgwLCAiaGVpZ2h0IjogMjAwfSwKICAgICAgICAia2V5d29yZHMiOiBbIllPVURJRUQiLCAiWU9VRElFIiwgIllPVUQxRUQiLCAiWU9VRGxFRCIsICJZT1VESSIsICJPVURJRUQiLCAiWU9VRElFMCJdLAogICAgICAgICJ0ZXNzZXJhY3RfY29uZmlnIjogIi0tb2VtIDMgLS1wc20gNyAtYyB0ZXNzZWRpdF9jaGFyX3doaXRlbGlzdD1ZT1VESUVBREZUIiwKICAgICAgICAibW9uaXRvcl9pbmRleCI6IDIsCiAgICAgICAgInByb2Nlc3NfbmFtZXMiOiBbImRhcmtzb3Vsc2lpaS5leGUiLCAiZGFyayBzb3VscyBpaWkuZXhlIl0sCiAgICB9LAogICAgIkRhcmsgU291bHMgUmVtYXN0ZXJlZCI6IHsKICAgICAgICAicmVnaW9uIjogeyJsZWZ0IjogNTIwLCAidG9wIjogNDcwLCAid2lkdGgiOiA4ODAsICJoZWlnaHQiOiAyMDB9LAogICAgICAgICJrZXl3b3JkcyI6IFsiWU9VRElFRCIsICJZT1VESUUiLCAiWU9VRDFFRCIsICJZT1VEbEVEIiwgIllPVURJIiwgIk9VRElFRCIsICJZT1VESUUwIl0sCiAgICAgICAgInRlc3NlcmFjdF9jb25maWciOiAiLS1vZW0gMyAtLXBzbSA3IC1jIHRlc3NlZGl0X2NoYXJfd2hpdGVsaXN0PVlPVURJRUFERlQiLAogICAgICAgICJtb25pdG9yX2luZGV4IjogMiwKICAgICAgICAicHJvY2Vzc19uYW1lcyI6IFsiZGFya3NvdWxzcmVtYXN0ZXJlZC5leGUiLCAiZGFyayBzb3VscyByZW1hc3RlcmVkLmV4ZSJdLAogICAgfSwKICAgICJEYXJrIFNvdWxzIElJOiBTY2hvbGFyIG9mIHRoZSBGaXJzdCBTaW4iOiB7CiAgICAgICAgInJlZ2lvbiI6IHsibGVmdCI6IDUyMCwgInRvcCI6IDQ3MCwgIndpZHRoIjogODgwLCAiaGVpZ2h0IjogMjAwfSwKICAgICAgICAia2V5d29yZHMiOiBbIllPVURJRUQiLCAiWU9VRElFIiwgIllPVUQxRUQiLCAiWU9VRGxFRCIsICJZT1VESSIsICJPVURJRUQiLCAiWU9VRElFMCJdLAogICAgICAgICJ0ZXNzZXJhY3RfY29uZmlnIjogIi0tb2VtIDMgLS1wc20gNyAtYyB0ZXNzZWRpdF9jaGFyX3doaXRlbGlzdD1ZT1VESUVBREZUIiwKICAgICAgICAibW9uaXRvcl9pbmRleCI6IDIsCiAgICAgICAgInByb2Nlc3NfbmFtZXMiOiBbImRhcmtzb3Vsc2lpLmV4ZSIsICJkYXJrIHNvdWxzIGlpLmV4ZSIsICJkYXJrc291bHMyLmV4ZSJdLAogICAgfSwKICAgICJTZWtpcm8iOiB7CiAgICAgICAgInJlZ2lvbiI6IHsibGVmdCI6IDUyMCwgInRvcCI6IDQ3MCwgIndpZHRoIjogODgwLCAiaGVpZ2h0IjogMjAwfSwKICAgICAgICAia2V5d29yZHMiOiBbIllPVURJRUQiLCAiWU9VRElFIiwgIkRFQVRIIl0sCiAgICAgICAgInRlc3NlcmFjdF9jb25maWciOiAiLS1vZW0gMyAtLXBzbSA3IC1jIHRlc3NlZGl0X2NoYXJfd2hpdGVsaXN0PVlPVURJRUFERlQiLAogICAgICAgICJtb25pdG9yX2luZGV4IjogMiwKICAgICAgICAicHJvY2Vzc19uYW1lcyI6IFsic2VraXJvLmV4ZSJdLAogICAgfSwKfQoKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PQojIERQSSBBV0FSRU5FU1MKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CmRlZiBlbmFibGVfZHBpX2F3YXJlbmVzcygpOgogICAgdHJ5OgogICAgICAgIGN0eXBlcy53aW5kbGwuc2hjb3JlLlNldFByb2Nlc3NEcGlBd2FyZW5lc3MoMikKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjdHlwZXMud2luZGxsLnVzZXIzMi5TZXRQcm9jZXNzRFBJQXdhcmUoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHBhc3MKCgpkZWYgbW92ZV9jb25zb2xlX3RvX3RvcF9yaWdodCgpOgogICAgIiIiTW92ZSBjb25zb2xlIHdpbmRvdyB0byB0b3AgcmlnaHQgY29ybmVyIHNvIGl0IGRvZXNuJ3QgaW50ZXJmZXJlIHdpdGggY2FwdHVyZS4iIiIKICAgIHRyeToKICAgICAgICBpbXBvcnQgc3lzCiAgICAgICAgaWYgc3lzLnBsYXRmb3JtID09ICJ3aW4zMiI6CiAgICAgICAgICAgIGltcG9ydCBvcwogICAgICAgICAgICAjIEdldCBjb25zb2xlIHdpbmRvdyBoYW5kbGUKICAgICAgICAgICAga2VybmVsMzIgPSBjdHlwZXMud2luZGxsLmtlcm5lbDMyCiAgICAgICAgICAgIHVzZXIzMiA9IGN0eXBlcy53aW5kbGwudXNlcjMyCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEdldCBjb25zb2xlIHdpbmRvdwogICAgICAgICAgICBod25kID0ga2VybmVsMzIuR2V0Q29uc29sZVdpbmRvdygpCiAgICAgICAgICAgIGlmIGh3bmQ6CiAgICAgICAgICAgICAgICAjIEdldCBzY3JlZW4gZGltZW5zaW9ucwogICAgICAgICAgICAgICAgc2NyZWVuX3dpZHRoID0gdXNlcjMyLkdldFN5c3RlbU1ldHJpY3MoMCkgICMgU01fQ1hTQ1JFRU4KICAgICAgICAgICAgICAgIHNjcmVlbl9oZWlnaHQgPSB1c2VyMzIuR2V0U3lzdGVtTWV0cmljcygxKSAgIyBTTV9DWVNDUkVFTgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIENvbnNvbGUgd2luZG93IHNpemUgKGFwcHJveGltYXRlKQogICAgICAgICAgICAgICAgd2luZG93X3dpZHRoID0gODAwCiAgICAgICAgICAgICAgICB3aW5kb3dfaGVpZ2h0ID0gNjAwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgUG9zaXRpb24gaW4gdG9wIHJpZ2h0IGNvcm5lcgogICAgICAgICAgICAgICAgeCA9IHNjcmVlbl93aWR0aCAtIHdpbmRvd193aWR0aCAtIDIwICAjIDIwcHggbWFyZ2luIGZyb20gcmlnaHQKICAgICAgICAgICAgICAgIHkgPSAyMCAgIyAyMHB4IG1hcmdpbiBmcm9tIHRvcAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIE1vdmUgd2luZG93CiAgICAgICAgICAgICAgICB1c2VyMzIuU2V0V2luZG93UG9zKGh3bmQsIDAsIHgsIHksIHdpbmRvd193aWR0aCwgd2luZG93X2hlaWdodCwgMHgwMDQwKSAgIyBTV1BfU0hPV1dJTkRPVwogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzICAjIFNpbGVudGx5IGZhaWwgaWYgd2UgY2FuJ3QgbW92ZSB0aGUgd2luZG93CgoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CiMgTE9HR0lORwojID09PT09PT09PT09PT09PT09PT09PT09PT0KZGVmIGxvZyhtc2c6IHN0cik6CiAgICBvcy5tYWtlZGlycyhCQVNFX0RJUiwgZXhpc3Rfb2s9VHJ1ZSkKICAgIHRzID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIlslWS0lbS0lZCAlSDolTTolU10iKQogICAgd2l0aCBvcGVuKERFQlVHX0xPRywgImEiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgIGYud3JpdGUoZiJ7dHN9IHttc2d9XG4iKQogICAgcHJpbnQobXNnKSAgIyBBbHNvIHByaW50IHRvIGNvbnNvbGUKCgojID09PT09PT09PT09PT09PT09PT09PT09PT0KIyBDT05GSUdVUkFUSU9OIE1BTkFHRU1FTlQKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CmRlZiBsb2FkX2NvbmZpZygpIC0+IERpY3Q6CiAgICAiIiJMb2FkIGdhbWUgY29uZmlndXJhdGlvbnMgZnJvbSBKU09OIGZpbGUsIG9yIGNyZWF0ZSBkZWZhdWx0LiIiIgogICAgb3MubWFrZWRpcnMoQkFTRV9ESVIsIGV4aXN0X29rPVRydWUpCiAgICAKICAgIGlmIG9zLnBhdGguZXhpc3RzKENPTkZJR19GSUxFKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggb3BlbihDT05GSUdfRklMRSwgInIiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICAgICAgY29uZmlnID0ganNvbi5sb2FkKGYpCiAgICAgICAgICAgICMgTWVyZ2Ugd2l0aCBkZWZhdWx0cyB0byBlbnN1cmUgYWxsIGtleXMgZXhpc3QKICAgICAgICAgICAgc2V0dGluZ3MgPSB7KipERUZBVUxUX1NFVFRJTkdTLCAqKmNvbmZpZy5nZXQoInNldHRpbmdzIiwge30pfQogICAgICAgICAgICBnYW1lcyA9IHsqKkRFRkFVTFRfR0FNRVMsICoqY29uZmlnLmdldCgiZ2FtZXMiLCB7fSl9CiAgICAgICAgICAgIHJldHVybiB7InNldHRpbmdzIjogc2V0dGluZ3MsICJnYW1lcyI6IGdhbWVzfQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nKGYiRXJyb3IgbG9hZGluZyBjb25maWc6IHtlfS4gVXNpbmcgZGVmYXVsdHMuIikKICAgIAogICAgIyBDcmVhdGUgZGVmYXVsdCBjb25maWcgZmlsZQogICAgZGVmYXVsdF9jb25maWcgPSB7CiAgICAgICAgInNldHRpbmdzIjogREVGQVVMVF9TRVRUSU5HUywKICAgICAgICAiZ2FtZXMiOiBERUZBVUxUX0dBTUVTLAogICAgICAgICJjdXJyZW50X2dhbWUiOiBsaXN0KERFRkFVTFRfR0FNRVMua2V5cygpKVswXSBpZiBERUZBVUxUX0dBTUVTIGVsc2UgTm9uZQogICAgfQogICAgc2F2ZV9jb25maWcoZGVmYXVsdF9jb25maWcpCiAgICByZXR1cm4gZGVmYXVsdF9jb25maWcKCgpkZWYgc2F2ZV9jb25maWcoY29uZmlnOiBEaWN0KToKICAgICIiIlNhdmUgY29uZmlndXJhdGlvbiB0byBKU09OIGZpbGUuIiIiCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKENPTkZJR19GSUxFLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChjb25maWcsIGYsIGluZGVudD0yKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZyhmIkVycm9yIHNhdmluZyBjb25maWc6IHtlfSIpCgoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CiMgTE9DSyBIQU5ETElORwojID09PT09PT09PT09PT09PT09PT09PT09PT0KZGVmIGFjcXVpcmVfbG9jaygpIC0+IGJvb2w6CiAgICBvcy5tYWtlZGlycyhCQVNFX0RJUiwgZXhpc3Rfb2s9VHJ1ZSkKICAgIGlmIG9zLnBhdGguZXhpc3RzKExPQ0tfRklMRSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4oTE9DS19GSUxFLCAiciIpIGFzIGY6CiAgICAgICAgICAgICAgICBwaWQgPSBmLnJlYWQoKS5zdHJpcCgpCiAgICAgICAgICAgIGxvZyhmIkxPQ0sgRVhJU1RTOiBkYWVtb24ubG9jayBwcmVzZW50IChQSUQ6IHtwaWR9KS4gRXhpdGluZyB0byBhdm9pZCBkdXBsaWNhdGVzLiIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBsb2coIkxPQ0sgRVhJU1RTOiBkYWVtb24ubG9jayBwcmVzZW50LiBFeGl0aW5nIHRvIGF2b2lkIGR1cGxpY2F0ZXMuIikKICAgICAgICByZXR1cm4gRmFsc2UKICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4oTE9DS19GSUxFLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoc3RyKG9zLmdldHBpZCgpKSkKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZyhmIkxPQ0sgRVJST1I6IHtlfSIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIHJlbGVhc2VfbG9jaygpOgogICAgdHJ5OgogICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKExPQ0tfRklMRSk6CiAgICAgICAgICAgIG9zLnJlbW92ZShMT0NLX0ZJTEUpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHBhc3MKCgojID09PT09PT09PT09PT09PT09PT09PT09PT0KIyBTVEFURSBNQU5BR0VNRU5UCiMgPT09PT09PT09PT09PT09PT09PT09PT09PQpkZWYgbG9hZF9zdGF0ZSgpIC0+IERpY3Q6CiAgICAiIiJMb2FkIHN0YXRlIGZyb20gSlNPTiBmaWxlLiIiIgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKFNUQVRFX0pTT04pOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJ0b3RhbF9kZWF0aHMiOiAwLAogICAgICAgICAgICAiZ2FtZV9kZWF0aHMiOiB7fSwKICAgICAgICAgICAgInRpY2siOiAwLAogICAgICAgICAgICAic3RyZWFrIjogMCwKICAgICAgICAgICAgImxhc3RfZGVhdGhfdHMiOiAwLjAsCiAgICAgICAgICAgICJjdXJyZW50X2dhbWUiOiBOb25lLAogICAgICAgIH0KICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4oU1RBVEVfSlNPTiwgInIiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICBzdGF0ZSA9IGpzb24ubG9hZChmKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBzdGF0ZSA9IHt9CiAgICAKICAgIHN0YXRlLnNldGRlZmF1bHQoInRvdGFsX2RlYXRocyIsIDApCiAgICBzdGF0ZS5zZXRkZWZhdWx0KCJnYW1lX2RlYXRocyIsIHt9KQogICAgc3RhdGUuc2V0ZGVmYXVsdCgidGljayIsIDApCiAgICBzdGF0ZS5zZXRkZWZhdWx0KCJzdHJlYWsiLCAwKQogICAgc3RhdGUuc2V0ZGVmYXVsdCgibGFzdF9kZWF0aF90cyIsIDAuMCkKICAgIHN0YXRlLnNldGRlZmF1bHQoImN1cnJlbnRfZ2FtZSIsIE5vbmUpCiAgICByZXR1cm4gc3RhdGUKCgpkZWYgc2F2ZV9zdGF0ZShzdGF0ZTogRGljdCk6CiAgICAiIiJTYXZlIHN0YXRlIHRvIEpTT04gZmlsZS4iIiIKICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4oU1RBVEVfSlNPTiwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoc3RhdGUsIGYsIGluZGVudD0yKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZyhmIkVycm9yIHNhdmluZyBzdGF0ZToge2V9IikKCgpkZWYgd3JpdGVfdGV4dChkZWF0aHM6IGludCwgZ2FtZV9uYW1lOiBzdHIgPSBOb25lKToKICAgICIiIldyaXRlIGRlYXRoIGNvdW50IHRvIHRleHQgZmlsZSBmb3IgT0JTLiIiIgogICAgdHJ5OgogICAgICAgICMgV3JpdGUgdG90YWwgZGVhdGhzCiAgICAgICAgd2l0aCBvcGVuKERFQVRIX1RYVCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICBmLndyaXRlKHN0cihkZWF0aHMpKQogICAgICAgIAogICAgICAgICMgQWxzbyB3cml0ZSBwZXItZ2FtZSBmaWxlIGlmIGdhbWUgbmFtZSBwcm92aWRlZAogICAgICAgIGlmIGdhbWVfbmFtZToKICAgICAgICAgICAgZ2FtZV90eHQgPSBvcy5wYXRoLmpvaW4oQkFTRV9ESVIsIGYiZGVhdGhfY291bnRlcl97Z2FtZV9uYW1lLnJlcGxhY2UoJyAnLCAnXycpfS50eHQiKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzdGF0ZSA9IGxvYWRfc3RhdGUoKQogICAgICAgICAgICAgICAgZ2FtZV9kZWF0aHMgPSBzdGF0ZS5nZXQoImdhbWVfZGVhdGhzIiwge30pLmdldChnYW1lX25hbWUsIDApCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZ2FtZV90eHQsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKHN0cihnYW1lX2RlYXRocykpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZyhmIkVycm9yIHdyaXRpbmcgZ2FtZSB0ZXh0IGZpbGU6IHtlfSIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nKGYiRXJyb3Igd3JpdGluZyBkZWF0aCB0ZXh0OiB7ZX0iKQoKCmRlZiB3cml0ZV9jaGF0X2luZm8oZ2FtZV9uYW1lOiBzdHIsIGRlYXRoX2NvdW50OiBpbnQpOgogICAgIiIiV3JpdGUgc2ltcGxlIHRleHQgZmlsZXMgZm9yIFN0cmVhbWVyLmJvdCBjaGF0IGNvbW1hbmQuCiAgICBDcmVhdGVzIHR3byBzZXBhcmF0ZSBmaWxlczoKICAgIC0gY3VycmVudF9nYW1lLnR4dDogSnVzdCB0aGUgZ2FtZSBuYW1lCiAgICAtIGN1cnJlbnRfZGVhdGhzLnR4dDogSnVzdCB0aGUgZGVhdGggY291bnQKICAgIFRoaXMgbWFrZXMgaXQgZWFzaWVyIGZvciBTdHJlYW1lci5ib3QgdG8gcmVhZC4KICAgICIiIgogICAgdHJ5OgogICAgICAgICMgV3JpdGUgZ2FtZSBuYW1lIHRvIHNlcGFyYXRlIGZpbGUKICAgICAgICB3aXRoIG9wZW4oQ1VSUkVOVF9HQU1FX1RYVCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOgogICAgICAgICAgICBmLndyaXRlKGdhbWVfbmFtZSkKICAgICAgICAKICAgICAgICAjIFdyaXRlIGRlYXRoIGNvdW50IHRvIHNlcGFyYXRlIGZpbGUKICAgICAgICB3aXRoIG9wZW4oQ1VSUkVOVF9ERUFUSFNfVFhULCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoc3RyKGRlYXRoX2NvdW50KSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2coZiJFcnJvciB3cml0aW5nIGNoYXQgaW5mbzoge2V9IikKCgpkZWYgd3JpdGVfdG90YWxfZGVhdGhzKHRvdGFsX2RlYXRoczogaW50KToKICAgICIiIldyaXRlIHRvdGFsIGRlYXRocyBhY3Jvc3MgYWxsIGdhbWVzIHRvIGEgc2VwYXJhdGUgZmlsZSBmb3IgU3RyZWFtZXIuYm90LiIiIgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihUT1RBTF9ERUFUSFNfVFhULCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoc3RyKHRvdGFsX2RlYXRocykpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nKGYiRXJyb3Igd3JpdGluZyB0b3RhbCBkZWF0aHM6IHtlfSIpCgoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CiMgR0FNRSBERVRFQ1RJT04KIyA9PT09PT09PT09PT09PT09PT09PT09PT09CmRlZiBnZXRfcnVubmluZ19wcm9jZXNzZXMoKSAtPiBMaXN0W3N0cl06CiAgICAiIiJHZXQgbGlzdCBvZiBhbGwgcnVubmluZyBwcm9jZXNzIG5hbWVzIChsb3dlcmNhc2UsIHdpdGhvdXQgLmV4ZSkuIiIiCiAgICBwcm9jZXNzZXMgPSBbXQogICAgdHJ5OgogICAgICAgIGZvciBwcm9jIGluIHBzdXRpbC5wcm9jZXNzX2l0ZXIoWyduYW1lJ10pOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBwcm9jX25hbWUgPSBwcm9jLmluZm9bJ25hbWUnXS5sb3dlcigpCiAgICAgICAgICAgICAgICAjIFJlbW92ZSAuZXhlIGV4dGVuc2lvbiBmb3IgbWF0Y2hpbmcKICAgICAgICAgICAgICAgIGlmIHByb2NfbmFtZS5lbmRzd2l0aCgnLmV4ZScpOgogICAgICAgICAgICAgICAgICAgIHByb2NfbmFtZSA9IHByb2NfbmFtZVs6LTRdCiAgICAgICAgICAgICAgICBwcm9jZXNzZXMuYXBwZW5kKHByb2NfbmFtZSkKICAgICAgICAgICAgZXhjZXB0IChwc3V0aWwuTm9TdWNoUHJvY2VzcywgcHN1dGlsLkFjY2Vzc0RlbmllZCk6CiAgICAgICAgICAgICAgICBwYXNzCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nKGYiRXJyb3IgZ2V0dGluZyBwcm9jZXNzZXM6IHtlfSIpCiAgICByZXR1cm4gcHJvY2Vzc2VzCgoKZGVmIGRldGVjdF9nYW1lKGdhbWVzOiBEaWN0KSAtPiBPcHRpb25hbFtzdHJdOgogICAgIiIiCiAgICBBdXRvLWRldGVjdCB3aGljaCBnYW1lIGlzIGN1cnJlbnRseSBydW5uaW5nIGJ5IGNoZWNraW5nIHByb2Nlc3MgbmFtZXMuCiAgICBSZXR1cm5zIHRoZSBnYW1lIG5hbWUgaWYgZGV0ZWN0ZWQsIE5vbmUgb3RoZXJ3aXNlLgogICAgIiIiCiAgICBydW5uaW5nX3Byb2NzID0gZ2V0X3J1bm5pbmdfcHJvY2Vzc2VzKCkKICAgIAogICAgIyBDaGVjayBlYWNoIGdhbWUncyBwcm9jZXNzIG5hbWVzCiAgICBmb3IgZ2FtZV9uYW1lLCBnYW1lX2NvbmZpZyBpbiBnYW1lcy5pdGVtcygpOgogICAgICAgIHByb2Nlc3NfbmFtZXMgPSBnYW1lX2NvbmZpZy5nZXQoInByb2Nlc3NfbmFtZXMiLCBbXSkKICAgICAgICBpZiBub3QgcHJvY2Vzc19uYW1lczoKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICAjIENoZWNrIGlmIGFueSBvZiB0aGlzIGdhbWUncyBwcm9jZXNzIG5hbWVzIGFyZSBydW5uaW5nCiAgICAgICAgZm9yIHByb2NfbmFtZSBpbiBwcm9jZXNzX25hbWVzOgogICAgICAgICAgICAjIE5vcm1hbGl6ZTogcmVtb3ZlIC5leGUsIGxvd2VyY2FzZQogICAgICAgICAgICBub3JtYWxpemVkID0gcHJvY19uYW1lLmxvd2VyKCkKICAgICAgICAgICAgaWYgbm9ybWFsaXplZC5lbmRzd2l0aCgnLmV4ZScpOgogICAgICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWRbOi00XQogICAgICAgICAgICAKICAgICAgICAgICAgIyBDaGVjayBpZiB0aGlzIHByb2Nlc3MgaXMgcnVubmluZwogICAgICAgICAgICBpZiBub3JtYWxpemVkIGluIHJ1bm5pbmdfcHJvY3M6CiAgICAgICAgICAgICAgICBsb2coZiJBdXRvLWRldGVjdGVkIGdhbWU6IHtnYW1lX25hbWV9IChwcm9jZXNzOiB7cHJvY19uYW1lfSkiKQogICAgICAgICAgICAgICAgcmV0dXJuIGdhbWVfbmFtZQogICAgCiAgICByZXR1cm4gTm9uZQoKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PQojIElNQUdFIFBST0NFU1NJTkcKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CmRlZiBncmFiX3JlZ2lvbihzY3Q6IG1zcywgbW9uaXRvcl9pbmRleDogaW50LCByZWdpb246IGRpY3QpIC0+IEltYWdlLkltYWdlOgogICAgIiIiQ2FwdHVyZSBhIHJlZ2lvbiBmcm9tIHRoZSBzcGVjaWZpZWQgbW9uaXRvci4iIiIKICAgICMgbXNzIHVzZXMgMC1pbmRleGVkIG1vbml0b3JzICgwIGlzIGFsbCBtb25pdG9ycywgMSsgYXJlIGluZGl2aWR1YWwpCiAgICAjIEJ1dCB3ZSdsbCB1c2UgMS1pbmRleGVkIGZvciB1c2VyIGNvbnZlbmllbmNlCiAgICBhY3R1YWxfaW5kZXggPSBtb25pdG9yX2luZGV4IGlmIG1vbml0b3JfaW5kZXggPT0gMCBlbHNlIG1vbml0b3JfaW5kZXgKICAgIAogICAgaWYgYWN0dWFsX2luZGV4ID49IGxlbihzY3QubW9uaXRvcnMpOgogICAgICAgIGxvZyhmIldBUk5JTkc6IE1vbml0b3Ige21vbml0b3JfaW5kZXh9IG5vdCBmb3VuZC4gVXNpbmcgbW9uaXRvciAxLiIpCiAgICAgICAgYWN0dWFsX2luZGV4ID0gMQogICAgCiAgICBtb24gPSBzY3QubW9uaXRvcnNbYWN0dWFsX2luZGV4XQogICAgYWJzX3JlZ2lvbiA9IHsKICAgICAgICAibGVmdCI6IG1vblsibGVmdCJdICsgcmVnaW9uWyJsZWZ0Il0sCiAgICAgICAgInRvcCI6IG1vblsidG9wIl0gKyByZWdpb25bInRvcCJdLAogICAgICAgICJ3aWR0aCI6IHJlZ2lvblsid2lkdGgiXSwKICAgICAgICAiaGVpZ2h0IjogcmVnaW9uWyJoZWlnaHQiXSwKICAgIH0KICAgIGdyYWIgPSBzY3QuZ3JhYihhYnNfcmVnaW9uKQogICAgcmV0dXJuIEltYWdlLmZyb21ieXRlcygiUkdCIiwgZ3JhYi5zaXplLCBncmFiLnJnYikKCgpkZWYgcHJlcHJvY2Vzc19mb3Jfb2NyKGltZ19yZ2I6IEltYWdlLkltYWdlKSAtPiBUdXBsZVtJbWFnZS5JbWFnZSwgRGljdF06CiAgICAiIiIKICAgIFByZXByb2Nlc3MgaW1hZ2UgZm9yIE9DUiB3aXRoIG11bHRpcGxlIGZhbGxiYWNrIHN0cmF0ZWdpZXMuCiAgICBGaXhlcyB0aGUgYmxhY2sgaW1hZ2UgaXNzdWUgYnkgdXNpbmcgcm9idXN0IHByZXByb2Nlc3NpbmcgbWV0aG9kcy4KICAgICIiIgogICAgcmdiID0gbnAuYXJyYXkoaW1nX3JnYikKICAgIGJnciA9IGN2Mi5jdnRDb2xvcihyZ2IsIGN2Mi5DT0xPUl9SR0IyQkdSKQogICAgCiAgICBkZWYgdXBzY2FsZShpbWdfY3YpOgogICAgICAgICIiIlVwc2NhbGUgaW1hZ2UgMnggZm9yIGJldHRlciBPQ1IuIiIiCiAgICAgICAgcmV0dXJuIGN2Mi5yZXNpemUoaW1nX2N2LCBOb25lLCBmeD0yLjAsIGZ5PTIuMCwgaW50ZXJwb2xhdGlvbj1jdjIuSU5URVJfQ1VCSUMpCiAgICAKICAgICMgU3RyYXRlZ3kgMTogVHJ5IEhTViByZWQgbWFzayAoZm9yICJZT1UgRElFRCIgcmVkIHRleHQpCiAgICBoc3YgPSBjdjIuY3Z0Q29sb3IoYmdyLCBjdjIuQ09MT1JfQkdSMkhTVikKICAgIAogICAgIyBXaWRlIHJlZCB0aHJlc2hvbGRzIChib3RoIGxvdyBhbmQgaGlnaCBodWUgcmFuZ2VzKQogICAgbG93ZXIxID0gbnAuYXJyYXkoWzAsIDMwLCAzMF0sIGR0eXBlPW5wLnVpbnQ4KQogICAgdXBwZXIxID0gbnAuYXJyYXkoWzE1LCAyNTUsIDI1NV0sIGR0eXBlPW5wLnVpbnQ4KQogICAgbG93ZXIyID0gbnAuYXJyYXkoWzE2NSwgMzAsIDMwXSwgZHR5cGU9bnAudWludDgpCiAgICB1cHBlcjIgPSBucC5hcnJheShbMTgwLCAyNTUsIDI1NV0sIGR0eXBlPW5wLnVpbnQ4KQogICAgCiAgICBtYXNrMSA9IGN2Mi5pblJhbmdlKGhzdiwgbG93ZXIxLCB1cHBlcjEpCiAgICBtYXNrMiA9IGN2Mi5pblJhbmdlKGhzdiwgbG93ZXIyLCB1cHBlcjIpCiAgICBtYXNrID0gY3YyLmJpdHdpc2Vfb3IobWFzazEsIG1hc2syKQogICAgCiAgICAjIENsZWFuIG5vaXNlCiAgICBrZXJuZWwgPSBucC5vbmVzKCgzLCAzKSwgbnAudWludDgpCiAgICBtYXNrID0gY3YyLm1vcnBob2xvZ3lFeChtYXNrLCBjdjIuTU9SUEhfT1BFTiwga2VybmVsLCBpdGVyYXRpb25zPTEpCiAgICBtYXNrID0gY3YyLm1vcnBob2xvZ3lFeChtYXNrLCBjdjIuTU9SUEhfQ0xPU0UsIGtlcm5lbCwgaXRlcmF0aW9ucz0yKQogICAgbWFzayA9IGN2Mi5kaWxhdGUobWFzaywga2VybmVsLCBpdGVyYXRpb25zPTEpCiAgICAKICAgIHdoaXRlID0gaW50KGN2Mi5jb3VudE5vblplcm8obWFzaykpCiAgICB0b3RhbCA9IGludChtYXNrLnNoYXBlWzBdICogbWFzay5zaGFwZVsxXSkKICAgIGNvdmVyYWdlID0gd2hpdGUgLyBtYXgoMSwgdG90YWwpCiAgICAKICAgIGluZm8gPSB7Im1vZGUiOiAiSFNWX1JFRCIsICJjb3ZlcmFnZSI6IGNvdmVyYWdlfQogICAgCiAgICAjIFVzZSByZWQgbWFzayBpZiBjb3ZlcmFnZSBpcyByZWFzb25hYmxlIChhdCBsZWFzdCAwLjUlIG9mIGltYWdlKQogICAgaWYgY292ZXJhZ2UgPj0gMC4wMDU6CiAgICAgICAgIyBJbnZlcnQgbWFzazogd2hpdGUgdGV4dCBvbiBibGFjayBiYWNrZ3JvdW5kIC0+IGJsYWNrIHRleHQgb24gd2hpdGUKICAgICAgICBpbnYgPSBjdjIuYml0d2lzZV9ub3QobWFzaykKICAgICAgICBvdXQgPSB1cHNjYWxlKGludikKICAgICAgICByZXR1cm4gSW1hZ2UuZnJvbWFycmF5KG91dCksIGluZm8KICAgIAogICAgIyBTdHJhdGVneSAyOiBHcmF5c2NhbGUgd2l0aCBhZGFwdGl2ZSB0aHJlc2hvbGQgKHdvcmtzIGZvciBhbnkgdGV4dCBjb2xvcikKICAgICMgVGhpcyBmYWxsYmFjayBlbnN1cmVzIHdlIE5FVkVSIGdldCBhIGJsYWNrIGltYWdlIC0gYWRhcHRpdmUgdGhyZXNob2xkIGFsd2F5cyBwcm9kdWNlcyBvdXRwdXQKICAgIGdyYXkgPSBjdjIuY3Z0Q29sb3IoYmdyLCBjdjIuQ09MT1JfQkdSMkdSQVkpCiAgICBncmF5X2JsdXIgPSBjdjIuR2F1c3NpYW5CbHVyKGdyYXksICgzLCAzKSwgMCkKICAgIHRocl9hZGFwdCA9IGN2Mi5hZGFwdGl2ZVRocmVzaG9sZCgKICAgICAgICBncmF5X2JsdXIsIDI1NSwKICAgICAgICBjdjIuQURBUFRJVkVfVEhSRVNIX0dBVVNTSUFOX0MsCiAgICAgICAgY3YyLlRIUkVTSF9CSU5BUlksCiAgICAgICAgMzEsIDUKICAgICkKICAgICMgSW52ZXJ0OiBtYWtlIHRleHQgZGFyayBvbiBsaWdodCBiYWNrZ3JvdW5kIChUZXNzZXJhY3QgcHJlZmVycyBkYXJrIHRleHQgb24gbGlnaHQpCiAgICB0aHJfYWRhcHRfaW52ID0gY3YyLmJpdHdpc2Vfbm90KHRocl9hZGFwdCkKICAgIG91dCA9IHVwc2NhbGUodGhyX2FkYXB0X2ludikKICAgIGluZm9bIm1vZGUiXSA9ICJBREFQVElWRV9USFJFU0hPTEQiCiAgICBpbmZvWyJjb3ZlcmFnZSJdID0gMC4wICAjIFNldCBjb3ZlcmFnZSBmb3IgY29uc2lzdGVuY3kKICAgIHJldHVybiBJbWFnZS5mcm9tYXJyYXkob3V0KSwgaW5mbwoKCmRlZiBvY3JfdGV4dChpbWdfZm9yX29jcjogSW1hZ2UuSW1hZ2UsIHRlc3NlcmFjdF9jb25maWc6IHN0cikgLT4gc3RyOgogICAgIiIiRXh0cmFjdCB0ZXh0IGZyb20gaW1hZ2UgdXNpbmcgT0NSLiIiIgogICAgdHJ5OgogICAgICAgIHRleHQgPSBweXRlc3NlcmFjdC5pbWFnZV90b19zdHJpbmcoaW1nX2Zvcl9vY3IsIGxhbmc9ImVuZyIsIGNvbmZpZz10ZXNzZXJhY3RfY29uZmlnKQogICAgICAgICMgUmVtb3ZlIGFsbCBub24tYWxwaGFiZXRpYyBjaGFyYWN0ZXJzIGFuZCB1cHBlcmNhc2UKICAgICAgICBjbGVhbiA9ICIiLmpvaW4oYyBmb3IgYyBpbiB0ZXh0LnVwcGVyKCkgaWYgYy5pc2FscGhhKCkpCiAgICAgICAgcmV0dXJuIGNsZWFuCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nKGYiT0NSIGVycm9yOiB7ZX0iKQogICAgICAgIHJldHVybiAiIgoKCmRlZiBjb250YWluc19rZXl3b3JkKGNsZWFuX3RleHQ6IHN0ciwga2V5d29yZHM6IExpc3Rbc3RyXSkgLT4gYm9vbDoKICAgICIiIkNoZWNrIGlmIGNsZWFuZWQgdGV4dCBjb250YWlucyBhbnkga2V5d29yZC4iIiIKICAgICMgRXhjbHVkZSBmYWxzZSBwb3NpdGl2ZXM6IGVuZW15IGZlbGxlZCwgdGFyZ2V0IGRlc3Ryb3llZCwgZXRjLgogICAgZXhjbHVkZV9rZXl3b3JkcyA9IFsiRU5FTVlGRUxMRUQiLCAiRU5FTVlGRUxMRSIsICJUQVJHRVRERVNUUk9ZRUQiLCAiVEFSR0VUREVTVFJPWUUiXQogICAgZm9yIGV4Y2x1ZGUgaW4gZXhjbHVkZV9rZXl3b3JkczoKICAgICAgICBpZiBleGNsdWRlIGluIGNsZWFuX3RleHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgCiAgICByZXR1cm4gYW55KGsgaW4gY2xlYW5fdGV4dCBmb3IgayBpbiBrZXl3b3JkcykKCgojID09PT09PT09PT09PT09PT09PT09PT09PT0KIyBNQUlOIExPT1AKIyA9PT09PT09PT09PT09PT09PT09PT09PT09CmRlZiBtYWluX2xvb3AoKToKICAgIG9zLm1ha2VkaXJzKEJBU0VfRElSLCBleGlzdF9vaz1UcnVlKQogICAgZW5hYmxlX2RwaV9hd2FyZW5lc3MoKQogICAgbW92ZV9jb25zb2xlX3RvX3RvcF9yaWdodCgpICAjIE1vdmUgY29uc29sZSB3aW5kb3cgb3V0IG9mIGNhcHR1cmUgYXJlYQogICAgCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoVEVTU0VSQUNUX0VYRSk6CiAgICAgICAgbG9nKGYiRVJST1I6IFRlc3NlcmFjdCBub3QgZm91bmQgYXQ6IHtURVNTRVJBQ1RfRVhFfSIpCiAgICAgICAgbG9nKCJQbGVhc2UgaW5zdGFsbCBUZXNzZXJhY3QgT0NSIG9yIHVwZGF0ZSBURVNTRVJBQ1RfRVhFIHBhdGguIikKICAgICAgICByZXR1cm4KICAgIAogICAgY29uZmlnID0gbG9hZF9jb25maWcoKQogICAgc2V0dGluZ3MgPSBjb25maWdbInNldHRpbmdzIl0KICAgIGdhbWVzID0gY29uZmlnWyJnYW1lcyJdCiAgICAKICAgIGlmIG5vdCBnYW1lczoKICAgICAgICBsb2coIkVSUk9SOiBObyBnYW1lcyBjb25maWd1cmVkISIpCiAgICAgICAgcmV0dXJuCiAgICAKICAgIHN0YXRlID0gbG9hZF9zdGF0ZSgpCiAgICAKICAgICMgVHJ5IGF1dG8tZGV0ZWN0aW9uIGZpcnN0CiAgICBkZXRlY3RlZF9nYW1lID0gZGV0ZWN0X2dhbWUoZ2FtZXMpCiAgICBpZiBkZXRlY3RlZF9nYW1lIGFuZCBkZXRlY3RlZF9nYW1lIGluIGdhbWVzOgogICAgICAgIGN1cnJlbnRfZ2FtZV9uYW1lID0gZGV0ZWN0ZWRfZ2FtZQogICAgICAgIGxvZyhmIkF1dG8tZGV0ZWN0ZWQgZ2FtZToge2N1cnJlbnRfZ2FtZV9uYW1lfSIpCiAgICBlbHNlOgogICAgICAgICMgRmFsbCBiYWNrIHRvIHNhdmVkIGdhbWUgb3IgZmlyc3QgZ2FtZQogICAgICAgIGN1cnJlbnRfZ2FtZV9uYW1lID0gc3RhdGUuZ2V0KCJjdXJyZW50X2dhbWUiKSBvciBjb25maWcuZ2V0KCJjdXJyZW50X2dhbWUiKSBvciBsaXN0KGdhbWVzLmtleXMoKSlbMF0KICAgICAgICBpZiBkZXRlY3RlZF9nYW1lIGlzIE5vbmU6CiAgICAgICAgICAgIGxvZyhmIk5vIGdhbWUgZGV0ZWN0ZWQgcnVubmluZy4gVXNpbmcgc2F2ZWQgZ2FtZToge2N1cnJlbnRfZ2FtZV9uYW1lfSIpCiAgICAKICAgIGlmIGN1cnJlbnRfZ2FtZV9uYW1lIG5vdCBpbiBnYW1lczoKICAgICAgICBjdXJyZW50X2dhbWVfbmFtZSA9IGxpc3QoZ2FtZXMua2V5cygpKVswXQogICAgCiAgICBnYW1lX2NvbmZpZyA9IGdhbWVzW2N1cnJlbnRfZ2FtZV9uYW1lXQogICAgc3RhdGVbImN1cnJlbnRfZ2FtZSJdID0gY3VycmVudF9nYW1lX25hbWUKICAgIAogICAgIyBHZXQgdGhlIGN1cnJlbnQgZ2FtZSdzIGRlYXRoIGNvdW50IChub3QgdG90YWwpCiAgICBnYW1lX2RlYXRocyA9IHN0YXRlLmdldCgiZ2FtZV9kZWF0aHMiLCB7fSkuZ2V0KGN1cnJlbnRfZ2FtZV9uYW1lLCAwKQogICAgIyBXcml0ZSBpbml0aWFsIHRleHQgZmlsZSBzbyBPQlMgaGFzIGN1cnJlbnQgZ2FtZSdzIGNvdW50IG9uIHN0YXJ0dXAKICAgIHdyaXRlX3RleHQoZ2FtZV9kZWF0aHMsIGN1cnJlbnRfZ2FtZV9uYW1lKQogICAgIyBXcml0ZSBpbml0aWFsIGNoYXQgaW5mbyBmaWxlCiAgICB3cml0ZV9jaGF0X2luZm8oY3VycmVudF9nYW1lX25hbWUsIGdhbWVfZGVhdGhzKQogICAgIyBXcml0ZSBpbml0aWFsIHRvdGFsIGRlYXRocyBmaWxlCiAgICB3cml0ZV90b3RhbF9kZWF0aHMoc3RhdGUuZ2V0KCJ0b3RhbF9kZWF0aHMiLCAwKSkKICAgIAogICAgbG9nKCI9IiAqIDYwKQogICAgbG9nKCJNdWx0aS1HYW1lIERlYXRoIENvdW50ZXIgRGFlbW9uIFN0YXJ0ZWQiKQogICAgbG9nKGYiQ3VycmVudCBHYW1lOiB7Y3VycmVudF9nYW1lX25hbWV9IikKICAgIGxvZyhmIk1vbml0b3I6IHtnYW1lX2NvbmZpZy5nZXQoJ21vbml0b3JfaW5kZXgnLCBzZXR0aW5nc1snbW9uaXRvcl9pbmRleCddKX0iKQogICAgbG9nKGYiUmVnaW9uOiB7Z2FtZV9jb25maWcuZ2V0KCdyZWdpb24nLCB7fSl9IikKICAgIGxvZyhmIktleXdvcmRzOiB7Z2FtZV9jb25maWcuZ2V0KCdrZXl3b3JkcycsIFtdKX0iKQogICAgbG9nKGYiQ3VycmVudCBEZWF0aHMgLSBUb3RhbDoge3N0YXRlWyd0b3RhbF9kZWF0aHMnXX0sIHtjdXJyZW50X2dhbWVfbmFtZX06IHtzdGF0ZVsnZ2FtZV9kZWF0aHMnXS5nZXQoY3VycmVudF9nYW1lX25hbWUsIDApfSIpCiAgICBsb2coIj0iICogNjApCiAgICAKICAgIHdpdGggbXNzKCkgYXMgc2N0OgogICAgICAgIGxvZyhmIkF2YWlsYWJsZSBtb25pdG9yczoge2xlbihzY3QubW9uaXRvcnMpfSIpCiAgICAgICAgZm9yIGksIG1vbiBpbiBlbnVtZXJhdGUoc2N0Lm1vbml0b3JzKToKICAgICAgICAgICAgbG9nKGYiICBNb25pdG9yIHtpfToge21vblsnd2lkdGgnXX14e21vblsnaGVpZ2h0J119IGF0ICh7bW9uWydsZWZ0J119LCB7bW9uWyd0b3AnXX0pIikKICAgICAgICAKICAgICAgICBtb25pdG9yX2luZGV4ID0gZ2FtZV9jb25maWcuZ2V0KCJtb25pdG9yX2luZGV4Iiwgc2V0dGluZ3NbIm1vbml0b3JfaW5kZXgiXSkKICAgICAgICByZWdpb24gPSBnYW1lX2NvbmZpZy5nZXQoInJlZ2lvbiIsIHt9KQogICAgICAgIGtleXdvcmRzID0gZ2FtZV9jb25maWcuZ2V0KCJrZXl3b3JkcyIsIFsiWU9VRElFRCJdKQogICAgICAgIHRlc3NlcmFjdF9jb25maWcgPSBnYW1lX2NvbmZpZy5nZXQoInRlc3NlcmFjdF9jb25maWciLCAiLS1vZW0gMyAtLXBzbSA3IikKICAgICAgICAKICAgICAgICAjIEF1dG8tZGV0ZWN0aW9uIGNoZWNrIGludGVydmFsIChjaGVjayBldmVyeSAzMCB0aWNrcyA9IH45IHNlY29uZHMgYXQgMC4zcyB0aWNrKQogICAgICAgIGF1dG9fZGV0ZWN0X2ludGVydmFsID0gMzAKICAgICAgICBsYXN0X2F1dG9fZGV0ZWN0X3RpY2sgPSAwCiAgICAgICAgCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoU1RPUF9GSUxFKToKICAgICAgICAgICAgICAgIGxvZygiU1RPUCBmaWxlIGRldGVjdGVkLiBFeGl0aW5nIGNsZWFubHkuIikKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIAogICAgICAgICAgICBzdGF0ZVsidGljayJdICs9IDEKICAgICAgICAgICAgbm93ID0gdGltZS50aW1lKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQXV0by1kZXRlY3QgZ2FtZSBwZXJpb2RpY2FsbHkKICAgICAgICAgICAgaWYgc3RhdGVbInRpY2siXSAtIGxhc3RfYXV0b19kZXRlY3RfdGljayA+PSBhdXRvX2RldGVjdF9pbnRlcnZhbDoKICAgICAgICAgICAgICAgIGRldGVjdGVkX2dhbWUgPSBkZXRlY3RfZ2FtZShnYW1lcykKICAgICAgICAgICAgICAgIGlmIGRldGVjdGVkX2dhbWUgYW5kIGRldGVjdGVkX2dhbWUgaW4gZ2FtZXMgYW5kIGRldGVjdGVkX2dhbWUgIT0gY3VycmVudF9nYW1lX25hbWU6CiAgICAgICAgICAgICAgICAgICAgbG9nKGYi8J+UhCBHYW1lIGNoYW5nZWQgZGV0ZWN0ZWQ6IHtjdXJyZW50X2dhbWVfbmFtZX0g4oaSIHtkZXRlY3RlZF9nYW1lfSIpCiAgICAgICAgICAgICAgICAgICAgY3VycmVudF9nYW1lX25hbWUgPSBkZXRlY3RlZF9nYW1lCiAgICAgICAgICAgICAgICAgICAgZ2FtZV9jb25maWcgPSBnYW1lc1tjdXJyZW50X2dhbWVfbmFtZV0KICAgICAgICAgICAgICAgICAgICBzdGF0ZVsiY3VycmVudF9nYW1lIl0gPSBjdXJyZW50X2dhbWVfbmFtZQogICAgICAgICAgICAgICAgICAgICMgVXBkYXRlIGNvbmZpZyBmaWxlCiAgICAgICAgICAgICAgICAgICAgY29uZmlnWyJjdXJyZW50X2dhbWUiXSA9IGN1cnJlbnRfZ2FtZV9uYW1lCiAgICAgICAgICAgICAgICAgICAgc2F2ZV9jb25maWcoY29uZmlnKQogICAgICAgICAgICAgICAgICAgICMgR2V0IHRoZSBuZXcgZ2FtZSdzIGRlYXRoIGNvdW50CiAgICAgICAgICAgICAgICAgICAgZ2FtZV9kZWF0aHMgPSBzdGF0ZS5nZXQoImdhbWVfZGVhdGhzIiwge30pLmdldChjdXJyZW50X2dhbWVfbmFtZSwgMCkKICAgICAgICAgICAgICAgICAgICAjIFdyaXRlIHVwZGF0ZWQgdGV4dCBmaWxlcyB3aXRoIHRoZSBuZXcgZ2FtZSdzIGNvdW50CiAgICAgICAgICAgICAgICAgICAgd3JpdGVfdGV4dChnYW1lX2RlYXRocywgY3VycmVudF9nYW1lX25hbWUpCiAgICAgICAgICAgICAgICAgICAgIyBXcml0ZSB1cGRhdGVkIGNoYXQgaW5mbwogICAgICAgICAgICAgICAgICAgIHdyaXRlX2NoYXRfaW5mbyhjdXJyZW50X2dhbWVfbmFtZSwgZ2FtZV9kZWF0aHMpCiAgICAgICAgICAgICAgICAgICAgIyBXcml0ZSB1cGRhdGVkIHRvdGFsIGRlYXRocwogICAgICAgICAgICAgICAgICAgIHdyaXRlX3RvdGFsX2RlYXRocyhzdGF0ZS5nZXQoInRvdGFsX2RlYXRocyIsIDApKQogICAgICAgICAgICAgICAgICAgICMgVXBkYXRlIG1vbml0b3IgYW5kIHJlZ2lvbiBzZXR0aW5ncwogICAgICAgICAgICAgICAgICAgIG1vbml0b3JfaW5kZXggPSBnYW1lX2NvbmZpZy5nZXQoIm1vbml0b3JfaW5kZXgiLCBzZXR0aW5nc1sibW9uaXRvcl9pbmRleCJdKQogICAgICAgICAgICAgICAgICAgIHJlZ2lvbiA9IGdhbWVfY29uZmlnLmdldCgicmVnaW9uIiwge30pCiAgICAgICAgICAgICAgICAgICAga2V5d29yZHMgPSBnYW1lX2NvbmZpZy5nZXQoImtleXdvcmRzIiwgWyJZT1VESUVEIl0pCiAgICAgICAgICAgICAgICAgICAgdGVzc2VyYWN0X2NvbmZpZyA9IGdhbWVfY29uZmlnLmdldCgidGVzc2VyYWN0X2NvbmZpZyIsICItLW9lbSAzIC0tcHNtIDciKQogICAgICAgICAgICAgICAgICAgIGxvZyhmIlN3aXRjaGVkIHRvOiB7Y3VycmVudF9nYW1lX25hbWV9IHwgTW9uaXRvcjoge21vbml0b3JfaW5kZXh9IHwgUmVnaW9uOiB7cmVnaW9ufSB8IERlYXRoczoge2dhbWVfZGVhdGhzfSIpCiAgICAgICAgICAgICAgICBsYXN0X2F1dG9fZGV0ZWN0X3RpY2sgPSBzdGF0ZVsidGljayJdCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIENhcHR1cmUgcmVnaW9uCiAgICAgICAgICAgICAgICBpbWdfcmdiID0gZ3JhYl9yZWdpb24oc2N0LCBtb25pdG9yX2luZGV4LCByZWdpb24pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgU2F2ZSBkZWJ1ZyBpbWFnZXMgcGVyaW9kaWNhbGx5CiAgICAgICAgICAgICAgICBzYXZlX2RlYnVnID0gKHN0YXRlWyJ0aWNrIl0gJSBzZXR0aW5nc1siZGVidWdfZXZlcnlfdGlja3MiXSA9PSAwKQogICAgICAgICAgICAgICAgaWYgc2F2ZV9kZWJ1ZzoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGltZ19yZ2Iuc2F2ZShERUJVR19SQVcpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICBsb2coZiJERUJVRyBSQVcgU0FWRSBFUlJPUjoge2V9IikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBQcmVwcm9jZXNzICsgT0NSCiAgICAgICAgICAgICAgICBvY3JfaW1nLCBpbmZvID0gcHJlcHJvY2Vzc19mb3Jfb2NyKGltZ19yZ2IpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHNhdmVfZGVidWc6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBvY3JfaW1nLnNhdmUoREVCVUdfT0NSKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nKGYiREVCVUcgT0NSIFNBVkUgRVJST1I6IHtlfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNsZWFuID0gb2NyX3RleHQob2NyX2ltZywgdGVzc2VyYWN0X2NvbmZpZykKICAgICAgICAgICAgICAgIGRldGVjdGVkID0gY29udGFpbnNfa2V5d29yZChjbGVhbiwga2V5d29yZHMpCiAgICAgICAgICAgICAgICBzdGF0ZVsic3RyZWFrIl0gPSAoc3RhdGVbInN0cmVhayJdICsgMSkgaWYgZGV0ZWN0ZWQgZWxzZSAwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgTG9nIHBlcmlvZGljYWxseQogICAgICAgICAgICAgICAgaWYgc3RhdGVbInRpY2siXSAlIDEwID09IDAgb3Igc2F2ZV9kZWJ1ZzoKICAgICAgICAgICAgICAgICAgICBjb3ZlcmFnZSA9IGluZm8uZ2V0KCdjb3ZlcmFnZScsIDAuMCkKICAgICAgICAgICAgICAgICAgICBsb2coZiJUaWNrPXtzdGF0ZVsndGljayddfSBHYW1lPXtjdXJyZW50X2dhbWVfbmFtZX0gTW9kZT17aW5mb1snbW9kZSddfSAiCiAgICAgICAgICAgICAgICAgICAgICAgIGYiQ292ZXJhZ2U9e2NvdmVyYWdlOi40Zn0gT0NSPSd7Y2xlYW59JyAiCiAgICAgICAgICAgICAgICAgICAgICAgIGYiRGV0ZWN0ZWQ9e2RldGVjdGVkfSBTdHJlYWs9e3N0YXRlWydzdHJlYWsnXX0ve3NldHRpbmdzWydjb25zZWN1dGl2ZV9oaXRzJ119IikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBDb3VudCBkZWF0aDogc3RhYmxlIGRldGVjdGlvbiArIGNvb2xkb3duCiAgICAgICAgICAgICAgICBjb29sZG93bl9wYXNzZWQgPSAobm93IC0gZmxvYXQoc3RhdGVbImxhc3RfZGVhdGhfdHMiXSkpID49IHNldHRpbmdzWyJjb29sZG93bl9zZWNvbmRzIl0KICAgICAgICAgICAgICAgIGlmIHN0YXRlWyJzdHJlYWsiXSA+PSBzZXR0aW5nc1siY29uc2VjdXRpdmVfaGl0cyJdIGFuZCBjb29sZG93bl9wYXNzZWQ6CiAgICAgICAgICAgICAgICAgICAgc3RhdGVbInRvdGFsX2RlYXRocyJdID0gaW50KHN0YXRlWyJ0b3RhbF9kZWF0aHMiXSkgKyAxCiAgICAgICAgICAgICAgICAgICAgc3RhdGVbImdhbWVfZGVhdGhzIl0uc2V0ZGVmYXVsdChjdXJyZW50X2dhbWVfbmFtZSwgMCkKICAgICAgICAgICAgICAgICAgICBzdGF0ZVsiZ2FtZV9kZWF0aHMiXVtjdXJyZW50X2dhbWVfbmFtZV0gPSBpbnQoc3RhdGVbImdhbWVfZGVhdGhzIl1bY3VycmVudF9nYW1lX25hbWVdKSArIDEKICAgICAgICAgICAgICAgICAgICBzdGF0ZVsibGFzdF9kZWF0aF90cyJdID0gbm93CiAgICAgICAgICAgICAgICAgICAgc3RhdGVbInN0cmVhayJdID0gMAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgU2F2ZSBzdGF0ZSBhbmQgd3JpdGUgdGV4dCBmaWxlCiAgICAgICAgICAgICAgICAgICAgc2F2ZV9zdGF0ZShzdGF0ZSkKICAgICAgICAgICAgICAgICAgICAjIFdyaXRlIHRoZSBjdXJyZW50IGdhbWUncyBkZWF0aCBjb3VudCAobm90IHRvdGFsKQogICAgICAgICAgICAgICAgICAgIGdhbWVfZGVhdGhzID0gc3RhdGVbImdhbWVfZGVhdGhzIl0uZ2V0KGN1cnJlbnRfZ2FtZV9uYW1lLCAwKQogICAgICAgICAgICAgICAgICAgIHdyaXRlX3RleHQoZ2FtZV9kZWF0aHMsIGN1cnJlbnRfZ2FtZV9uYW1lKQogICAgICAgICAgICAgICAgICAgICMgV3JpdGUgdXBkYXRlZCBjaGF0IGluZm8KICAgICAgICAgICAgICAgICAgICB3cml0ZV9jaGF0X2luZm8oY3VycmVudF9nYW1lX25hbWUsIGdhbWVfZGVhdGhzKQogICAgICAgICAgICAgICAgICAgICMgV3JpdGUgdXBkYXRlZCB0b3RhbCBkZWF0aHMKICAgICAgICAgICAgICAgICAgICB3cml0ZV90b3RhbF9kZWF0aHMoc3RhdGVbInRvdGFsX2RlYXRocyJdKQogICAgICAgICAgICAgICAgICAgIGxvZyhmIvCfkoAgREVBVEggQ09VTlRFRCDihpIgVG90YWw6IHtzdGF0ZVsndG90YWxfZGVhdGhzJ119IHwgIgogICAgICAgICAgICAgICAgICAgICAgICBmIntjdXJyZW50X2dhbWVfbmFtZX06IHtzdGF0ZVsnZ2FtZV9kZWF0aHMnXVtjdXJyZW50X2dhbWVfbmFtZV19IikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBTYXZlIHN0YXRlIHBlcmlvZGljYWxseSAoZXZlcnkgMTAgdGlja3MgdG8gcmVkdWNlIEkvTykKICAgICAgICAgICAgICAgIGlmIHN0YXRlWyJ0aWNrIl0gJSAxMCA9PSAwOgogICAgICAgICAgICAgICAgICAgIHNhdmVfc3RhdGUoc3RhdGUpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgbG9nKGYiRXJyb3IgaW4gbWFpbiBsb29wOiB7ZX0iKQogICAgICAgICAgICAgICAgbG9nKHRyYWNlYmFjay5mb3JtYXRfZXhjKCkpCiAgICAgICAgICAgIAogICAgICAgICAgICB0aW1lLnNsZWVwKHNldHRpbmdzWyJ0aWNrX3NlY29uZHMiXSkKCgojID09PT09PT09PT09PT09PT09PT09PT09PT0KIyBFTlRSWVBPSU5UCiMgPT09PT09PT09PT09PT09PT09PT09PT09PQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaWYgbm90IGFjcXVpcmVfbG9jaygpOgogICAgICAgIHByaW50KCJBbm90aGVyIGluc3RhbmNlIGlzIGFscmVhZHkgcnVubmluZy4gRXhpdGluZy4iKQogICAgICAgIHJhaXNlIFN5c3RlbUV4aXQoMCkKICAgIAogICAgdHJ5OgogICAgICAgIG1haW5fbG9vcCgpCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgbG9nKCJEYWVtb24gc3RvcHBlZCAoS2V5Ym9hcmRJbnRlcnJ1cHQpLiIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nKCJGQVRBTCBFUlJPUjogIiArIHN0cihlKSkKICAgICAgICBsb2codHJhY2ViYWNrLmZvcm1hdF9leGMoKSkKICAgIGZpbmFsbHk6CiAgICAgICAgcmVsZWFzZV9sb2NrKCkKICAgICAgICBsb2coIkRhZW1vbiBzaHV0ZG93biBjb21wbGV0ZS4iKQoK",
  "death_counter_gui.py": "IiIiDQpEZWF0aCBDb3VudGVyIEdVSSBBcHBsaWNhdGlvbg0KQSBzaW1wbGUgR1VJIHRvIGNvbnRyb2wgdGhlIGRlYXRoIGNvdW50ZXIgZGFlbW9uIGFuZCB2aWV3IHN0YXRzLg0KDQpUbyBjcmVhdGUgYW4gLmV4ZToNCiAgICBwaXAgaW5zdGFsbCBweWluc3RhbGxlcg0KICAgIHB5aW5zdGFsbGVyIC0tb25lZmlsZSAtLXdpbmRvd2VkIC0tbmFtZSAiRGVhdGhDb3VudGVyIiBkZWF0aF9jb3VudGVyX2d1aS5weQ0KIiIiDQoNCmltcG9ydCBvcw0KaW1wb3J0IHN5cw0KaW1wb3J0IGpzb24NCmltcG9ydCB0aW1lDQppbXBvcnQgc3VicHJvY2Vzcw0KaW1wb3J0IHRocmVhZGluZw0KZnJvbSB0a2ludGVyIGltcG9ydCAqDQpmcm9tIHRraW50ZXIgaW1wb3J0IHR0aywgbWVzc2FnZWJveA0KDQpCQVNFX0RJUiA9IHIiQzpcMWRlYXRoY291bnRlciINCkNPTkZJR19GSUxFID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZ2FtZXNfY29uZmlnLmpzb24iKQ0KU1RBVEVfSlNPTiA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYXRoX3N0YXRlLmpzb24iKQ0KTE9DS19GSUxFID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZGFlbW9uLmxvY2siKQ0KU1RPUF9GSUxFID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiU1RPUCIpDQpTQ1JJUFRfUEFUSCA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgIm11bHRpX2dhbWVfZGVhdGhfY291bnRlci5weSIpDQpERUFUSF9UWFQgPSBvcy5wYXRoLmpvaW4oQkFTRV9ESVIsICJkZWF0aF9jb3VudGVyLnR4dCIpDQoNCg0KY2xhc3MgRGVhdGhDb3VudGVyR1VJOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCByb290KToNCiAgICAgICAgc2VsZi5yb290ID0gcm9vdA0KICAgICAgICBzZWxmLnJvb3QudGl0bGUoIkRlYXRoIENvdW50ZXIgQ29udHJvbCIpDQogICAgICAgIHNlbGYucm9vdC5nZW9tZXRyeSgiNDAweDM0MCIpDQogICAgICAgIHNlbGYucm9vdC5yZXNpemFibGUoRmFsc2UsIEZhbHNlKQ0KICAgICAgICANCiAgICAgICAgIyBWYXJpYWJsZXMNCiAgICAgICAgc2VsZi5kYWVtb25fcHJvY2VzcyA9IE5vbmUNCiAgICAgICAgc2VsZi5tb25pdG9yaW5nID0gRmFsc2UNCiAgICAgICAgDQogICAgICAgICMgQ3JlYXRlIFVJDQogICAgICAgIHNlbGYuY3JlYXRlX3VpKCkNCiAgICAgICAgDQogICAgICAgICMgQ2hlY2sgaW5pdGlhbCBzdGF0ZSAoYWZ0ZXIgVUkgaXMgY3JlYXRlZCkNCiAgICAgICAgc2VsZi51cGRhdGVfc3RhdHVzKCkNCiAgICAgICAgDQogICAgICAgICMgU3RhcnQgbW9uaXRvcmluZyB0aHJlYWQNCiAgICAgICAgc2VsZi5zdGFydF9tb25pdG9yaW5nKCkNCiAgICANCiAgICBkZWYgY3JlYXRlX3VpKHNlbGYpOg0KICAgICAgICAjIE1haW4gZnJhbWUNCiAgICAgICAgbWFpbl9mcmFtZSA9IHR0ay5GcmFtZShzZWxmLnJvb3QsIHBhZGRpbmc9IjEwIikNCiAgICAgICAgbWFpbl9mcmFtZS5ncmlkKHJvdz0wLCBjb2x1bW49MCwgc3RpY2t5PShXLCBFLCBOLCBTKSkNCiAgICAgICAgDQogICAgICAgICMgVGl0bGUNCiAgICAgICAgdGl0bGVfbGFiZWwgPSB0dGsuTGFiZWwobWFpbl9mcmFtZSwgdGV4dD0iRGVhdGggQ291bnRlciIsIGZvbnQ9KCJBcmlhbCIsIDE2LCAiYm9sZCIpKQ0KICAgICAgICB0aXRsZV9sYWJlbC5ncmlkKHJvdz0wLCBjb2x1bW49MCwgY29sdW1uc3Bhbj0yLCBwYWR5PSgwLCAyMCkpDQogICAgICAgIA0KICAgICAgICAjIFN0YXR1cyBmcmFtZQ0KICAgICAgICBzdGF0dXNfZnJhbWUgPSB0dGsuTGFiZWxGcmFtZShtYWluX2ZyYW1lLCB0ZXh0PSJTdGF0dXMiLCBwYWRkaW5nPSIxMCIpDQogICAgICAgIHN0YXR1c19mcmFtZS5ncmlkKHJvdz0xLCBjb2x1bW49MCwgY29sdW1uc3Bhbj0yLCBzdGlja3k9KFcsIEUpLCBwYWR5PSgwLCAxMCkpDQogICAgICAgIA0KICAgICAgICAjIFN0YXR1cyBhbmQgdG90YWwgZGVhdGhzIGluIGEgcm93DQogICAgICAgIHN0YXR1c19yb3cgPSB0dGsuRnJhbWUoc3RhdHVzX2ZyYW1lKQ0KICAgICAgICBzdGF0dXNfcm93LmdyaWQocm93PTAsIGNvbHVtbj0wLCBzdGlja3k9KFcsIEUpKQ0KICAgICAgICBzdGF0dXNfZnJhbWUuY29sdW1uY29uZmlndXJlKDAsIHdlaWdodD0xKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5zdGF0dXNfbGFiZWwgPSB0dGsuTGFiZWwoc3RhdHVzX3JvdywgdGV4dD0iQ2hlY2tpbmcuLi4iLCBmb250PSgiQXJpYWwiLCAxMCkpDQogICAgICAgIHNlbGYuc3RhdHVzX2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBzdGlja3k9VykNCiAgICAgICAgDQogICAgICAgICMgVG90YWwgZGVhdGhzIGxhYmVsDQogICAgICAgIHNlbGYudG90YWxfZGVhdGhzX2xhYmVsID0gdHRrLkxhYmVsKHN0YXR1c19yb3csIHRleHQ9IlRvdGFsIERlYXRoczogMCIsIGZvbnQ9KCJBcmlhbCIsIDEwLCAiYm9sZCIpKQ0KICAgICAgICBzZWxmLnRvdGFsX2RlYXRoc19sYWJlbC5ncmlkKHJvdz0wLCBjb2x1bW49MSwgc3RpY2t5PUUsIHBhZHg9KDIwLCAwKSkNCiAgICAgICAgDQogICAgICAgICMgRGVhdGggY291bnQgZGlzcGxheSAtIExhcmdlIGNsaWNrYWJsZSBidXR0b24NCiAgICAgICAgY291bnRfZnJhbWUgPSB0dGsuRnJhbWUobWFpbl9mcmFtZSkNCiAgICAgICAgY291bnRfZnJhbWUuZ3JpZChyb3c9MiwgY29sdW1uPTAsIGNvbHVtbnNwYW49Miwgc3RpY2t5PShXLCBFKSwgcGFkeT0oMCwgMTApKQ0KICAgICAgICANCiAgICAgICAgIyBDcmVhdGUgYSBsYXJnZSBidXR0b24gdGhhdCBzaG93cyBkZWF0aCBjb3VudCBhbmQgZ2FtZSBuYW1lDQogICAgICAgICMgVXNlIGEgZnJhbWUgd2l0aCBsYWJlbCBmb3IgYmV0dGVyIHRleHQgY29udHJvbA0KICAgICAgICBidXR0b25fY29udGFpbmVyID0gRnJhbWUoY291bnRfZnJhbWUsIGJnPSIjZjBmMGYwIiwgcmVsaWVmPVJBSVNFRCwgYmQ9MykNCiAgICAgICAgYnV0dG9uX2NvbnRhaW5lci5ncmlkKHJvdz0wLCBjb2x1bW49MCwgc3RpY2t5PShXLCBFKSwgaXBhZHg9MTAsIGlwYWR5PTEwKQ0KICAgICAgICBjb3VudF9mcmFtZS5jb2x1bW5jb25maWd1cmUoMCwgd2VpZ2h0PTEpDQogICAgICAgIA0KICAgICAgICAjIERlYXRoIGNvdW50IGxhYmVsIChsYXJnZSkNCiAgICAgICAgc2VsZi5kZWF0aF9jb3VudF9sYWJlbCA9IExhYmVsKA0KICAgICAgICAgICAgYnV0dG9uX2NvbnRhaW5lciwNCiAgICAgICAgICAgIHRleHQ9IjAiLA0KICAgICAgICAgICAgZm9udD0oIkFyaWFsIiwgMjQsICJib2xkIiksDQogICAgICAgICAgICBiZz0iI2YwZjBmMCIsDQogICAgICAgICAgICBmZz0iYmxhY2siDQogICAgICAgICkNCiAgICAgICAgc2VsZi5kZWF0aF9jb3VudF9sYWJlbC5wYWNrKHBhZHk9KDEwLCA1KSkNCiAgICAgICAgDQogICAgICAgICMgR2FtZSBuYW1lIGxhYmVsIChzbWFsbGVyLCB3cmFwcykNCiAgICAgICAgc2VsZi5nYW1lX25hbWVfbGFiZWwgPSBMYWJlbCgNCiAgICAgICAgICAgIGJ1dHRvbl9jb250YWluZXIsDQogICAgICAgICAgICB0ZXh0PSJObyBnYW1lIHNlbGVjdGVkIiwNCiAgICAgICAgICAgIGZvbnQ9KCJBcmlhbCIsIDEwKSwNCiAgICAgICAgICAgIGJnPSIjZjBmMGYwIiwNCiAgICAgICAgICAgIGZnPSJibGFjayIsDQogICAgICAgICAgICB3cmFwbGVuZ3RoPTMyMCwNCiAgICAgICAgICAgIGp1c3RpZnk9Q0VOVEVSDQogICAgICAgICkNCiAgICAgICAgc2VsZi5nYW1lX25hbWVfbGFiZWwucGFjayhwYWR5PSgwLCAxMCkpDQogICAgICAgIA0KICAgICAgICAjIE1ha2UgdGhlIHdob2xlIGNvbnRhaW5lciBjbGlja2FibGUNCiAgICAgICAgc2VsZi5kZWF0aF9jb3VudF9idXR0b24gPSBidXR0b25fY29udGFpbmVyDQogICAgICAgICMgVXNlIEJ1dHRvblJlbGVhc2UtMSBmb3IgYmV0dGVyIGNsaWNrIGRldGVjdGlvbg0KICAgICAgICBidXR0b25fY29udGFpbmVyLmJpbmQoIjxCdXR0b25SZWxlYXNlLTE+IiwgbGFtYmRhIGU6IHNlbGYuY3ljbGVfZ2FtZSgpKQ0KICAgICAgICBidXR0b25fY29udGFpbmVyLmJpbmQoIjxFbnRlcj4iLCBsYW1iZGEgZTogc2VsZi5vbl9idXR0b25fZW50ZXIoYnV0dG9uX2NvbnRhaW5lcikpDQogICAgICAgIGJ1dHRvbl9jb250YWluZXIuYmluZCgiPExlYXZlPiIsIGxhbWJkYSBlOiBzZWxmLm9uX2J1dHRvbl9sZWF2ZShidXR0b25fY29udGFpbmVyKSkNCiAgICAgICAgc2VsZi5kZWF0aF9jb3VudF9sYWJlbC5iaW5kKCI8QnV0dG9uUmVsZWFzZS0xPiIsIGxhbWJkYSBlOiBzZWxmLmN5Y2xlX2dhbWUoKSkNCiAgICAgICAgc2VsZi5nYW1lX25hbWVfbGFiZWwuYmluZCgiPEJ1dHRvblJlbGVhc2UtMT4iLCBsYW1iZGEgZTogc2VsZi5jeWNsZV9nYW1lKCkpDQogICAgICAgIGJ1dHRvbl9jb250YWluZXIuY29uZmlnKGN1cnNvcj0iaGFuZDIiKQ0KICAgICAgICBzZWxmLmRlYXRoX2NvdW50X2xhYmVsLmNvbmZpZyhjdXJzb3I9ImhhbmQyIikNCiAgICAgICAgc2VsZi5nYW1lX25hbWVfbGFiZWwuY29uZmlnKGN1cnNvcj0iaGFuZDIiKQ0KICAgICAgICANCiAgICAgICAgIyBDb250cm9sIGJ1dHRvbnMgZnJhbWUNCiAgICAgICAgY29udHJvbF9mcmFtZSA9IHR0ay5MYWJlbEZyYW1lKG1haW5fZnJhbWUsIHRleHQ9IkNvbnRyb2wiLCBwYWRkaW5nPSIxMCIpDQogICAgICAgIGNvbnRyb2xfZnJhbWUuZ3JpZChyb3c9MywgY29sdW1uPTAsIGNvbHVtbnNwYW49Miwgc3RpY2t5PShXLCBFKSwgcGFkeT0oMCwgMCkpDQogICAgICAgIA0KICAgICAgICBzZWxmLnN0YXJ0X2J1dHRvbiA9IHR0ay5CdXR0b24oY29udHJvbF9mcmFtZSwgdGV4dD0iU3RhcnQgRGFlbW9uIiwgY29tbWFuZD1zZWxmLnN0YXJ0X2RhZW1vbiwgd2lkdGg9MTgpDQogICAgICAgIHNlbGYuc3RhcnRfYnV0dG9uLmdyaWQocm93PTAsIGNvbHVtbj0wLCBwYWR4PSgwLCA1KSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuc3RvcF9idXR0b24gPSB0dGsuQnV0dG9uKGNvbnRyb2xfZnJhbWUsIHRleHQ9IlN0b3AgRGFlbW9uIiwgY29tbWFuZD1zZWxmLnN0b3BfZGFlbW9uLCB3aWR0aD0xOCwgc3RhdGU9RElTQUJMRUQpDQogICAgICAgIHNlbGYuc3RvcF9idXR0b24uZ3JpZChyb3c9MCwgY29sdW1uPTEsIHBhZHg9KDUsIDApKQ0KICAgICAgICANCiAgICAgICAgIyBMb2FkIGF2YWlsYWJsZSBnYW1lcw0KICAgICAgICBzZWxmLmxvYWRfZ2FtZXMoKQ0KICAgIA0KICAgIGRlZiBvbl9idXR0b25fZW50ZXIoc2VsZiwgY29udGFpbmVyKToNCiAgICAgICAgIiIiQ2hhbmdlIGJhY2tncm91bmQgb24gaG92ZXIuIiIiDQogICAgICAgIGNvbnRhaW5lci5jb25maWcoYmc9IiNlMGUwZTAiKQ0KICAgICAgICBzZWxmLmRlYXRoX2NvdW50X2xhYmVsLmNvbmZpZyhiZz0iI2UwZTBlMCIpDQogICAgICAgIHNlbGYuZ2FtZV9uYW1lX2xhYmVsLmNvbmZpZyhiZz0iI2UwZTBlMCIpDQogICAgDQogICAgZGVmIG9uX2J1dHRvbl9sZWF2ZShzZWxmLCBjb250YWluZXIpOg0KICAgICAgICAiIiJSZXN0b3JlIGJhY2tncm91bmQgb24gbGVhdmUuIiIiDQogICAgICAgIGNvbnRhaW5lci5jb25maWcoYmc9IiNmMGYwZjAiKQ0KICAgICAgICBzZWxmLmRlYXRoX2NvdW50X2xhYmVsLmNvbmZpZyhiZz0iI2YwZjBmMCIpDQogICAgICAgIHNlbGYuZ2FtZV9uYW1lX2xhYmVsLmNvbmZpZyhiZz0iI2YwZjBmMCIpDQogICAgDQogICAgZGVmIGxvYWRfZ2FtZXMoc2VsZik6DQogICAgICAgICIiIkxvYWQgYXZhaWxhYmxlIGdhbWVzIGZyb20gY29uZmlnLiIiIg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhDT05GSUdfRklMRSk6DQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKENPTkZJR19GSUxFLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IGpzb24ubG9hZChmKQ0KICAgICAgICAgICAgICAgIHNlbGYuYXZhaWxhYmxlX2dhbWVzID0gbGlzdChjb25maWcuZ2V0KCJnYW1lcyIsIHt9KS5rZXlzKCkpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHNlbGYuYXZhaWxhYmxlX2dhbWVzID0gWyJFbGRlbiBSaW5nIiwgIkRhcmsgU291bHMgMyIsICJEYXJrIFNvdWxzIFJlbWFzdGVyZWQiLCAiU2VraXJvIl0NCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgc2VsZi5hdmFpbGFibGVfZ2FtZXMgPSBbIkVsZGVuIFJpbmciLCAiRGFyayBTb3VscyAzIiwgIkRhcmsgU291bHMgUmVtYXN0ZXJlZCIsICJTZWtpcm8iXQ0KICAgICAgICANCiAgICAgICAgaWYgbm90IHNlbGYuYXZhaWxhYmxlX2dhbWVzOg0KICAgICAgICAgICAgc2VsZi5hdmFpbGFibGVfZ2FtZXMgPSBbIk5vIGdhbWVzIGNvbmZpZ3VyZWQiXQ0KICAgIA0KICAgIGRlZiBnZXRfY3VycmVudF9nYW1lKHNlbGYpOg0KICAgICAgICAiIiJHZXQgY3VycmVudCBnYW1lIGZyb20gc3RhdGUgb3IgY29uZmlnLiIiIg0KICAgICAgICB0cnk6DQogICAgICAgICAgICAjIFRyeSBzdGF0ZSBmaWxlIGZpcnN0DQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhTVEFURV9KU09OKToNCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oU1RBVEVfSlNPTiwgInIiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IGpzb24ubG9hZChmKQ0KICAgICAgICAgICAgICAgIGdhbWUgPSBzdGF0ZS5nZXQoImN1cnJlbnRfZ2FtZSIpDQogICAgICAgICAgICAgICAgaWYgZ2FtZToNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBGYWxsIGJhY2sgdG8gY29uZmlnDQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhDT05GSUdfRklMRSk6DQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKENPTkZJR19GSUxFLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IGpzb24ubG9hZChmKQ0KICAgICAgICAgICAgICAgIHJldHVybiBjb25maWcuZ2V0KCJjdXJyZW50X2dhbWUiLCBzZWxmLmF2YWlsYWJsZV9nYW1lc1swXSBpZiBzZWxmLmF2YWlsYWJsZV9nYW1lcyBlbHNlICJVbmtub3duIikNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcGFzcw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHNlbGYuYXZhaWxhYmxlX2dhbWVzWzBdIGlmIHNlbGYuYXZhaWxhYmxlX2dhbWVzIGVsc2UgIlVua25vd24iDQogICAgDQogICAgZGVmIGdldF9kZWF0aF9jb3VudChzZWxmLCBnYW1lX25hbWUpOg0KICAgICAgICAiIiJHZXQgZGVhdGggY291bnQgZm9yIGEgc3BlY2lmaWMgZ2FtZS4iIiINCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoU1RBVEVfSlNPTik6DQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKFNUQVRFX0pTT04sICJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBqc29uLmxvYWQoZikNCiAgICAgICAgICAgICAgICBnYW1lX2RlYXRocyA9IHN0YXRlLmdldCgiZ2FtZV9kZWF0aHMiLCB7fSkNCiAgICAgICAgICAgICAgICByZXR1cm4gZ2FtZV9kZWF0aHMuZ2V0KGdhbWVfbmFtZSwgMCkNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcGFzcw0KICAgICAgICByZXR1cm4gMA0KICAgIA0KICAgIGRlZiBnZXRfdG90YWxfZGVhdGhzKHNlbGYpOg0KICAgICAgICAiIiJHZXQgdG90YWwgZGVhdGhzIGFjcm9zcyBhbGwgZ2FtZXMuIiIiDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKFNUQVRFX0pTT04pOg0KICAgICAgICAgICAgICAgIHdpdGggb3BlbihTVEFURV9KU09OLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICAgICAgICAgIHN0YXRlID0ganNvbi5sb2FkKGYpDQogICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlLmdldCgidG90YWxfZGVhdGhzIiwgMCkNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcGFzcw0KICAgICAgICByZXR1cm4gMA0KICAgIA0KICAgIGRlZiBjeWNsZV9nYW1lKHNlbGYsIGV2ZW50PU5vbmUpOg0KICAgICAgICAiIiJDeWNsZSB0byB0aGUgbmV4dCBnYW1lIGluIHRoZSBsaXN0LiIiIg0KICAgICAgICBpZiBub3Qgc2VsZi5hdmFpbGFibGVfZ2FtZXMgb3IgbGVuKHNlbGYuYXZhaWxhYmxlX2dhbWVzKSA9PSAwOg0KICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93d2FybmluZygiTm8gR2FtZXMiLCAiTm8gZ2FtZXMgY29uZmlndXJlZC4iKQ0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIA0KICAgICAgICBjdXJyZW50X2dhbWUgPSBzZWxmLmdldF9jdXJyZW50X2dhbWUoKQ0KICAgICAgICANCiAgICAgICAgIyBGaW5kIGN1cnJlbnQgaW5kZXgNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgY3VycmVudF9pbmRleCA9IHNlbGYuYXZhaWxhYmxlX2dhbWVzLmluZGV4KGN1cnJlbnRfZ2FtZSkNCiAgICAgICAgICAgIG5leHRfaW5kZXggPSAoY3VycmVudF9pbmRleCArIDEpICUgbGVuKHNlbGYuYXZhaWxhYmxlX2dhbWVzKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBuZXh0X2luZGV4ID0gMA0KICAgICAgICANCiAgICAgICAgbmV3X2dhbWUgPSBzZWxmLmF2YWlsYWJsZV9nYW1lc1tuZXh0X2luZGV4XQ0KICAgICAgICANCiAgICAgICAgIyBTd2l0Y2ggZ2FtZSB1c2luZyB0aGUgbWFudWFsIHN3aXRjaCBzY3JpcHQNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgc3dpdGNoX3NjcmlwdCA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgInN3aXRjaF9nYW1lX21hbnVhbC5weSIpDQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhzd2l0Y2hfc2NyaXB0KToNCiAgICAgICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigNCiAgICAgICAgICAgICAgICAgICAgW3N5cy5leGVjdXRhYmxlLCBzd2l0Y2hfc2NyaXB0LCBuZXdfZ2FtZV0sDQogICAgICAgICAgICAgICAgICAgIGNhcHR1cmVfb3V0cHV0PVRydWUsDQogICAgICAgICAgICAgICAgICAgIHRleHQ9VHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgY3dkPUJBU0VfRElSDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgIGlmIHJlc3VsdC5yZXR1cm5jb2RlID09IDA6DQogICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlX3N0YXR1cygpDQogICAgICAgICAgICAgICAgICAgICMgU2lsZW50bHkgc3dpdGNoIC0gbm8gcG9wdXANCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAjIEZhbGxiYWNrIHRvIGRpcmVjdCBzd2l0Y2ggaWYgc2NyaXB0IGZhaWxzDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc3dpdGNoX2dhbWVfZGlyZWN0KG5ld19nYW1lKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAjIEZhbGxiYWNrOiBkaXJlY3RseSB1cGRhdGUgY29uZmlnDQogICAgICAgICAgICAgICAgc2VsZi5zd2l0Y2hfZ2FtZV9kaXJlY3QobmV3X2dhbWUpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICMgRmFsbGJhY2sgdG8gZGlyZWN0IHN3aXRjaCBvbiBhbnkgZXJyb3INCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBzZWxmLnN3aXRjaF9nYW1lX2RpcmVjdChuZXdfZ2FtZSkNCiAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgICBwYXNzDQogICAgDQogICAgZGVmIHN3aXRjaF9nYW1lX2RpcmVjdChzZWxmLCBnYW1lX25hbWUpOg0KICAgICAgICAiIiJEaXJlY3RseSBzd2l0Y2ggZ2FtZSBieSB1cGRhdGluZyBjb25maWcgYW5kIHN0YXRlLiIiIg0KICAgICAgICB0cnk6DQogICAgICAgICAgICAjIFVwZGF0ZSBjb25maWcNCiAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKENPTkZJR19GSUxFKToNCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oQ09ORklHX0ZJTEUsICJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0ganNvbi5sb2FkKGYpDQogICAgICAgICAgICAgICAgY29uZmlnWyJjdXJyZW50X2dhbWUiXSA9IGdhbWVfbmFtZQ0KICAgICAgICAgICAgICAgIHdpdGggb3BlbihDT05GSUdfRklMRSwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAgICAgICAgICBqc29uLmR1bXAoY29uZmlnLCBmLCBpbmRlbnQ9MikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBVcGRhdGUgc3RhdGUNCiAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKFNUQVRFX0pTT04pOg0KICAgICAgICAgICAgICAgIHdpdGggb3BlbihTVEFURV9KU09OLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICAgICAgICAgIHN0YXRlID0ganNvbi5sb2FkKGYpDQogICAgICAgICAgICAgICAgc3RhdGVbImN1cnJlbnRfZ2FtZSJdID0gZ2FtZV9uYW1lDQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKFNUQVRFX0pTT04sICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgICAgICAgICAganNvbi5kdW1wKHN0YXRlLCBmLCBpbmRlbnQ9MikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBVcGRhdGUgdGV4dCBmaWxlDQogICAgICAgICAgICBnYW1lX2RlYXRocyA9IHNlbGYuZ2V0X2RlYXRoX2NvdW50KGdhbWVfbmFtZSkNCiAgICAgICAgICAgIHdpdGggb3BlbihERUFUSF9UWFQsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgICAgICBmLndyaXRlKHN0cihnYW1lX2RlYXRocykpDQogICAgICAgICAgICANCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3N0YXR1cygpDQogICAgICAgICAgICAjIFNpbGVudGx5IHN3aXRjaCAtIG5vIHBvcHVwDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiRmFpbGVkIHRvIHN3aXRjaCBnYW1lOiB7ZX0iKQ0KICAgIA0KICAgIGRlZiBpc19kYWVtb25fcnVubmluZyhzZWxmKToNCiAgICAgICAgIiIiQ2hlY2sgaWYgZGFlbW9uIGlzIHJ1bm5pbmcuIiIiDQogICAgICAgIHJldHVybiBvcy5wYXRoLmV4aXN0cyhMT0NLX0ZJTEUpDQogICAgDQogICAgZGVmIHN0YXJ0X2RhZW1vbihzZWxmKToNCiAgICAgICAgIiIiU3RhcnQgdGhlIGRlYXRoIGNvdW50ZXIgZGFlbW9uLiIiIg0KICAgICAgICBpZiBzZWxmLmlzX2RhZW1vbl9ydW5uaW5nKCk6DQogICAgICAgICAgICAjIFNpbGVudGx5IHJldHVybiAtIG5vIHBvcHVwDQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgDQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhTQ1JJUFRfUEFUSCk6DQogICAgICAgICAgICAjIFNpbGVudGx5IHJldHVybiAtIG5vIHBvcHVwDQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgDQogICAgICAgIHRyeToNCiAgICAgICAgICAgICMgU3RhcnQgZGFlbW9uIGluIGJhY2tncm91bmQNCiAgICAgICAgICAgIGlmIHN5cy5wbGF0Zm9ybSA9PSAid2luMzIiOg0KICAgICAgICAgICAgICAgIHNlbGYuZGFlbW9uX3Byb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKA0KICAgICAgICAgICAgICAgICAgICBbc3lzLmV4ZWN1dGFibGUsIFNDUklQVF9QQVRIXSwNCiAgICAgICAgICAgICAgICAgICAgY3dkPUJBU0VfRElSLA0KICAgICAgICAgICAgICAgICAgICBjcmVhdGlvbmZsYWdzPXN1YnByb2Nlc3MuQ1JFQVRFX05PX1dJTkRPVyBpZiBoYXNhdHRyKHN1YnByb2Nlc3MsICdDUkVBVEVfTk9fV0lORE9XJykgZWxzZSAwDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBzZWxmLmRhZW1vbl9wcm9jZXNzID0gc3VicHJvY2Vzcy5Qb3BlbigNCiAgICAgICAgICAgICAgICAgICAgW3N5cy5leGVjdXRhYmxlLCBTQ1JJUFRfUEFUSF0sDQogICAgICAgICAgICAgICAgICAgIGN3ZD1CQVNFX0RJUiwNCiAgICAgICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuREVWTlVMTCwNCiAgICAgICAgICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuREVWTlVMTA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBXYWl0IGEgbW9tZW50IGZvciBpdCB0byBzdGFydA0KICAgICAgICAgICAgdGltZS5zbGVlcCgyKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBzZWxmLmlzX2RhZW1vbl9ydW5uaW5nKCk6DQogICAgICAgICAgICAgICAgc2VsZi51cGRhdGVfc3RhdHVzKCkNCiAgICAgICAgICAgICAgICAjIFNpbGVudGx5IHN0YXJ0IC0gbm8gcG9wdXANCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgIyBTaWxlbnRseSBmYWlsIC0gbm8gcG9wdXANCiAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICMgU2lsZW50bHkgZmFpbCAtIG5vIHBvcHVwDQogICAgICAgICAgICBwYXNzDQogICAgDQogICAgZGVmIHN0b3BfZGFlbW9uKHNlbGYpOg0KICAgICAgICAiIiJTdG9wIHRoZSBkZWF0aCBjb3VudGVyIGRhZW1vbi4iIiINCiAgICAgICAgaWYgbm90IHNlbGYuaXNfZGFlbW9uX3J1bm5pbmcoKToNCiAgICAgICAgICAgICMgU2lsZW50bHkgcmV0dXJuIC0gbm8gcG9wdXANCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICANCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgIyBDcmVhdGUgU1RPUCBmaWxlDQogICAgICAgICAgICB3aXRoIG9wZW4oU1RPUF9GSUxFLCAidyIpIGFzIGY6DQogICAgICAgICAgICAgICAgZi53cml0ZSgiIikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBXYWl0IGZvciBkYWVtb24gdG8gc3RvcA0KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMTApOg0KICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkNCiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5pc19kYWVtb25fcnVubmluZygpOg0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIElmIHN0aWxsIHJ1bm5pbmcsIHRyeSB0byBraWxsIHByb2Nlc3MNCiAgICAgICAgICAgIGlmIHNlbGYuaXNfZGFlbW9uX3J1bm5pbmcoKToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihMT0NLX0ZJTEUsICJyIikgYXMgZjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHBpZCA9IGYucmVhZCgpLnN0cmlwKCkNCiAgICAgICAgICAgICAgICAgICAgaWYgcGlkOg0KICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJ0YXNra2lsbCIsICIvRiIsICIvUElEIiwgcGlkXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgY2hlY2s9RmFsc2UpDQogICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKExPQ0tfRklMRSk6DQogICAgICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUoTE9DS19GSUxFKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIENsZWFuIHVwDQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhTVE9QX0ZJTEUpOg0KICAgICAgICAgICAgICAgIG9zLnJlbW92ZShTVE9QX0ZJTEUpDQogICAgICAgICAgICANCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3N0YXR1cygpDQogICAgICAgICAgICAjIFNpbGVudGx5IHN0b3AgLSBubyBwb3B1cA0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAjIFNpbGVudGx5IGZhaWwgLSBubyBwb3B1cA0KICAgICAgICAgICAgcGFzcw0KICAgIA0KICAgIGRlZiB1cGRhdGVfc3RhdHVzKHNlbGYpOg0KICAgICAgICAiIiJVcGRhdGUgdGhlIFVJIHdpdGggY3VycmVudCBzdGF0dXMuIiIiDQogICAgICAgICMgQ2hlY2sgaWYgVUkgZWxlbWVudHMgZXhpc3QgKHRoZXkgbWlnaHQgbm90IGR1cmluZyBpbml0aWFsaXphdGlvbikNCiAgICAgICAgaWYgbm90IGhhc2F0dHIoc2VsZiwgJ3N0YXR1c19sYWJlbCcpOg0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIA0KICAgICAgICAjIFVwZGF0ZSBkYWVtb24gc3RhdHVzDQogICAgICAgIHJ1bm5pbmcgPSBzZWxmLmlzX2RhZW1vbl9ydW5uaW5nKCkNCiAgICAgICAgaWYgcnVubmluZzoNCiAgICAgICAgICAgIHNlbGYuc3RhdHVzX2xhYmVsLmNvbmZpZyh0ZXh0PSJTdGF0dXM6IFJ1bm5pbmciLCBmb3JlZ3JvdW5kPSJncmVlbiIpDQogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdzdGFydF9idXR0b24nKToNCiAgICAgICAgICAgICAgICBzZWxmLnN0YXJ0X2J1dHRvbi5jb25maWcoc3RhdGU9RElTQUJMRUQpDQogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdzdG9wX2J1dHRvbicpOg0KICAgICAgICAgICAgICAgIHNlbGYuc3RvcF9idXR0b24uY29uZmlnKHN0YXRlPU5PUk1BTCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHNlbGYuc3RhdHVzX2xhYmVsLmNvbmZpZyh0ZXh0PSJTdGF0dXM6IFN0b3BwZWQiLCBmb3JlZ3JvdW5kPSJyZWQiKQ0KICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnc3RhcnRfYnV0dG9uJyk6DQogICAgICAgICAgICAgICAgc2VsZi5zdGFydF9idXR0b24uY29uZmlnKHN0YXRlPU5PUk1BTCkNCiAgICAgICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgJ3N0b3BfYnV0dG9uJyk6DQogICAgICAgICAgICAgICAgc2VsZi5zdG9wX2J1dHRvbi5jb25maWcoc3RhdGU9RElTQUJMRUQpDQogICAgICAgIA0KICAgICAgICAjIFVwZGF0ZSBnYW1lIGFuZCBkZWF0aCBjb3VudCBvbiB0aGUgYnV0dG9uDQogICAgICAgIGN1cnJlbnRfZ2FtZSA9IHNlbGYuZ2V0X2N1cnJlbnRfZ2FtZSgpDQogICAgICAgIGRlYXRoX2NvdW50ID0gc2VsZi5nZXRfZGVhdGhfY291bnQoY3VycmVudF9nYW1lKQ0KICAgICAgICB0b3RhbF9kZWF0aHMgPSBzZWxmLmdldF90b3RhbF9kZWF0aHMoKQ0KICAgICAgICANCiAgICAgICAgIyBVcGRhdGUgdGhlIGxhYmVscyBzZXBhcmF0ZWx5DQogICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgJ2RlYXRoX2NvdW50X2xhYmVsJykgYW5kIGhhc2F0dHIoc2VsZiwgJ2dhbWVfbmFtZV9sYWJlbCcpOg0KICAgICAgICAgICAgc2VsZi5kZWF0aF9jb3VudF9sYWJlbC5jb25maWcodGV4dD1zdHIoZGVhdGhfY291bnQpKQ0KICAgICAgICAgICAgc2VsZi5nYW1lX25hbWVfbGFiZWwuY29uZmlnKHRleHQ9Y3VycmVudF9nYW1lKQ0KICAgICAgICANCiAgICAgICAgIyBVcGRhdGUgdG90YWwgZGVhdGhzIGRpc3BsYXkNCiAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAndG90YWxfZGVhdGhzX2xhYmVsJyk6DQogICAgICAgICAgICBzZWxmLnRvdGFsX2RlYXRoc19sYWJlbC5jb25maWcodGV4dD1mIlRvdGFsIERlYXRoczoge3RvdGFsX2RlYXRoc30iKQ0KICAgIA0KICAgIGRlZiBzdGFydF9tb25pdG9yaW5nKHNlbGYpOg0KICAgICAgICAiIiJTdGFydCBiYWNrZ3JvdW5kIHRocmVhZCB0byBtb25pdG9yIHN0YXR1cy4iIiINCiAgICAgICAgc2VsZi5tb25pdG9yaW5nID0gVHJ1ZQ0KICAgICAgICANCiAgICAgICAgZGVmIG1vbml0b3IoKToNCiAgICAgICAgICAgIHdoaWxlIHNlbGYubW9uaXRvcmluZzoNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHNlbGYucm9vdC5hZnRlcigwLCBzZWxmLnVwZGF0ZV9zdGF0dXMpDQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikgICMgVXBkYXRlIGV2ZXJ5IDIgc2Vjb25kcw0KICAgICAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgDQogICAgICAgIHRocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PW1vbml0b3IsIGRhZW1vbj1UcnVlKQ0KICAgICAgICB0aHJlYWQuc3RhcnQoKQ0KICAgIA0KICAgIGRlZiBvbl9jbG9zaW5nKHNlbGYpOg0KICAgICAgICAiIiJIYW5kbGUgd2luZG93IGNsb3NpbmcuIiIiDQogICAgICAgIHNlbGYubW9uaXRvcmluZyA9IEZhbHNlDQogICAgICAgIHNlbGYucm9vdC5kZXN0cm95KCkNCg0KDQpkZWYgbWFpbigpOg0KICAgIHJvb3QgPSBUaygpDQogICAgYXBwID0gRGVhdGhDb3VudGVyR1VJKHJvb3QpDQogICAgcm9vdC5wcm90b2NvbCgiV01fREVMRVRFX1dJTkRPVyIsIGFwcC5vbl9jbG9zaW5nKQ0KICAgIHJvb3QubWFpbmxvb3AoKQ0KDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgbWFpbigpDQoNCg==",
  "switch_game_manual.py": "IiIiDQpNYW51YWxseSBTd2l0Y2ggR2FtZQ0KU3dpdGNoIHRoZSBkZWF0aCBjb3VudGVyIHRvIGEgc3BlY2lmaWMgZ2FtZSBtYW51YWxseS4NCg0KVXNhZ2U6DQogICAgcHl0aG9uIHN3aXRjaF9nYW1lX21hbnVhbC5weSAiRWxkZW4gUmluZyINCiAgICBweXRob24gc3dpdGNoX2dhbWVfbWFudWFsLnB5ICJEYXJrIFNvdWxzIDMiDQoiIiINCg0KaW1wb3J0IG9zDQppbXBvcnQgc3lzDQppbXBvcnQganNvbg0KDQpCQVNFX0RJUiA9IHIiQzpcMWRlYXRoY291bnRlciINCkNPTkZJR19GSUxFID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZ2FtZXNfY29uZmlnLmpzb24iKQ0KU1RBVEVfSlNPTiA9IG9zLnBhdGguam9pbihCQVNFX0RJUiwgImRlYXRoX3N0YXRlLmpzb24iKQ0KREVBVEhfVFhUID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCAiZGVhdGhfY291bnRlci50eHQiKQ0KDQoNCmRlZiBsb2FkX2NvbmZpZygpOg0KICAgICIiIkxvYWQgZ2FtZSBjb25maWd1cmF0aW9ucyBmcm9tIEpTT04gZmlsZS4iIiINCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoQ09ORklHX0ZJTEUpOg0KICAgICAgICBwcmludChmIltFUlJPUl0gQ29uZmlnIGZpbGUgbm90IGZvdW5kOiB7Q09ORklHX0ZJTEV9IikNCiAgICAgICAgcmV0dXJuIE5vbmUNCiAgICANCiAgICB0cnk6DQogICAgICAgIHdpdGggb3BlbihDT05GSUdfRklMRSwgInIiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAgcmV0dXJuIGpzb24ubG9hZChmKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJbRVJST1JdIEZhaWxlZCB0byBsb2FkIGNvbmZpZzoge2V9IikNCiAgICAgICAgcmV0dXJuIE5vbmUNCg0KDQpkZWYgbG9hZF9zdGF0ZSgpOg0KICAgICIiIkxvYWQgc3RhdGUgZnJvbSBKU09OIGZpbGUuIiIiDQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKFNUQVRFX0pTT04pOg0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgInRvdGFsX2RlYXRocyI6IDAsDQogICAgICAgICAgICAiZ2FtZV9kZWF0aHMiOiB7fSwNCiAgICAgICAgICAgICJ0aWNrIjogMCwNCiAgICAgICAgICAgICJzdHJlYWsiOiAwLA0KICAgICAgICAgICAgImxhc3RfZGVhdGhfdHMiOiAwLjAsDQogICAgICAgICAgICAiY3VycmVudF9nYW1lIjogTm9uZSwNCiAgICAgICAgfQ0KICAgIA0KICAgIHRyeToNCiAgICAgICAgd2l0aCBvcGVuKFNUQVRFX0pTT04sICJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgIHN0YXRlID0ganNvbi5sb2FkKGYpDQogICAgZXhjZXB0Og0KICAgICAgICBzdGF0ZSA9IHt9DQogICAgDQogICAgc3RhdGUuc2V0ZGVmYXVsdCgidG90YWxfZGVhdGhzIiwgMCkNCiAgICBzdGF0ZS5zZXRkZWZhdWx0KCJnYW1lX2RlYXRocyIsIHt9KQ0KICAgIHN0YXRlLnNldGRlZmF1bHQoInRpY2siLCAwKQ0KICAgIHN0YXRlLnNldGRlZmF1bHQoInN0cmVhayIsIDApDQogICAgc3RhdGUuc2V0ZGVmYXVsdCgibGFzdF9kZWF0aF90cyIsIDAuMCkNCiAgICBzdGF0ZS5zZXRkZWZhdWx0KCJjdXJyZW50X2dhbWUiLCBOb25lKQ0KICAgIHJldHVybiBzdGF0ZQ0KDQoNCmRlZiBzYXZlX2NvbmZpZyhjb25maWcpOg0KICAgICIiIlNhdmUgY29uZmlndXJhdGlvbiB0byBKU09OIGZpbGUuIiIiDQogICAgdHJ5Og0KICAgICAgICB3aXRoIG9wZW4oQ09ORklHX0ZJTEUsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgIGpzb24uZHVtcChjb25maWcsIGYsIGluZGVudD0yKQ0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJbRVJST1JdIEZhaWxlZCB0byBzYXZlIGNvbmZpZzoge2V9IikNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCg0KZGVmIHNhdmVfc3RhdGUoc3RhdGUpOg0KICAgICIiIlNhdmUgc3RhdGUgdG8gSlNPTiBmaWxlLiIiIg0KICAgIHRyeToNCiAgICAgICAgd2l0aCBvcGVuKFNUQVRFX0pTT04sICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoNCiAgICAgICAgICAgIGpzb24uZHVtcChzdGF0ZSwgZiwgaW5kZW50PTIpDQogICAgICAgIHJldHVybiBUcnVlDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChmIltFUlJPUl0gRmFpbGVkIHRvIHNhdmUgc3RhdGU6IHtlfSIpDQogICAgICAgIHJldHVybiBGYWxzZQ0KDQoNCmRlZiB3cml0ZV90ZXh0KGRlYXRocywgZ2FtZV9uYW1lKToNCiAgICAiIiJXcml0ZSBkZWF0aCBjb3VudCB0byB0ZXh0IGZpbGUuIiIiDQogICAgdHJ5Og0KICAgICAgICAjIFdyaXRlIG1haW4gZmlsZQ0KICAgICAgICB3aXRoIG9wZW4oREVBVEhfVFhULCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICBmLndyaXRlKHN0cihkZWF0aHMpKQ0KICAgICAgICANCiAgICAgICAgIyBXcml0ZSBwZXItZ2FtZSBmaWxlDQogICAgICAgIGlmIGdhbWVfbmFtZToNCiAgICAgICAgICAgIGdhbWVfdHh0ID0gb3MucGF0aC5qb2luKEJBU0VfRElSLCBmImRlYXRoX2NvdW50ZXJfe2dhbWVfbmFtZS5yZXBsYWNlKCcgJywgJ18nKX0udHh0IikNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBzdGF0ZSA9IGxvYWRfc3RhdGUoKQ0KICAgICAgICAgICAgICAgIGdhbWVfZGVhdGhzID0gc3RhdGUuZ2V0KCJnYW1lX2RlYXRocyIsIHt9KS5nZXQoZ2FtZV9uYW1lLCAwKQ0KICAgICAgICAgICAgICAgIHdpdGggb3BlbihnYW1lX3R4dCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAgICAgICAgICBmLndyaXRlKHN0cihnYW1lX2RlYXRocykpDQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgcHJpbnQoZiJbV0FSTklOR10gQ291bGQgbm90IHdyaXRlIHBlci1nYW1lIGZpbGU6IHtlfSIpDQogICAgICAgIHJldHVybiBUcnVlDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChmIltFUlJPUl0gRmFpbGVkIHRvIHdyaXRlIHRleHQgZmlsZToge2V9IikNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCg0KZGVmIHN3aXRjaF9nYW1lKGdhbWVfbmFtZSk6DQogICAgIiIiU3dpdGNoIHRvIHRoZSBzcGVjaWZpZWQgZ2FtZS4iIiINCiAgICBwcmludCgiPSIgKiA3MCkNCiAgICBwcmludCgiTUFOVUFMIEdBTUUgU1dJVENIIikNCiAgICBwcmludCgiPSIgKiA3MCkNCiAgICANCiAgICAjIExvYWQgY29uZmlnDQogICAgY29uZmlnID0gbG9hZF9jb25maWcoKQ0KICAgIGlmIG5vdCBjb25maWc6DQogICAgICAgIHJldHVybiBGYWxzZQ0KICAgIA0KICAgIGdhbWVzID0gY29uZmlnLmdldCgiZ2FtZXMiLCB7fSkNCiAgICBpZiBub3QgZ2FtZXM6DQogICAgICAgIHByaW50KCJbRVJST1JdIE5vIGdhbWVzIGNvbmZpZ3VyZWQiKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICAjIENoZWNrIGlmIGdhbWUgZXhpc3RzDQogICAgaWYgZ2FtZV9uYW1lIG5vdCBpbiBnYW1lczoNCiAgICAgICAgcHJpbnQoZiJbRVJST1JdIEdhbWUgJ3tnYW1lX25hbWV9JyBub3QgZm91bmQgaW4gY29uZmlndXJhdGlvbi4iKQ0KICAgICAgICBwcmludChmIlxuQXZhaWxhYmxlIGdhbWVzOiIpDQogICAgICAgIGZvciBuYW1lIGluIGdhbWVzLmtleXMoKToNCiAgICAgICAgICAgIHByaW50KGYiICAtIHtuYW1lfSIpDQogICAgICAgIHJldHVybiBGYWxzZQ0KICAgIA0KICAgICMgTG9hZCBzdGF0ZQ0KICAgIHN0YXRlID0gbG9hZF9zdGF0ZSgpDQogICAgb2xkX2dhbWUgPSBzdGF0ZS5nZXQoImN1cnJlbnRfZ2FtZSIsICJVbmtub3duIikNCiAgICANCiAgICAjIFVwZGF0ZSBzdGF0ZQ0KICAgIHN0YXRlWyJjdXJyZW50X2dhbWUiXSA9IGdhbWVfbmFtZQ0KICAgIA0KICAgICMgVXBkYXRlIGNvbmZpZw0KICAgIGNvbmZpZ1siY3VycmVudF9nYW1lIl0gPSBnYW1lX25hbWUNCiAgICANCiAgICAjIEdldCB0aGUgZ2FtZSdzIGRlYXRoIGNvdW50DQogICAgZ2FtZV9kZWF0aHMgPSBzdGF0ZS5nZXQoImdhbWVfZGVhdGhzIiwge30pLmdldChnYW1lX25hbWUsIDApDQogICAgDQogICAgIyBTYXZlIGZpbGVzDQogICAgaWYgbm90IHNhdmVfc3RhdGUoc3RhdGUpOg0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICBpZiBub3Qgc2F2ZV9jb25maWcoY29uZmlnKToNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgDQogICAgIyBVcGRhdGUgdGV4dCBmaWxlcw0KICAgIHdyaXRlX3RleHQoZ2FtZV9kZWF0aHMsIGdhbWVfbmFtZSkNCiAgICANCiAgICAjIFNob3cgaW5mbw0KICAgIGdhbWVfY29uZmlnID0gZ2FtZXNbZ2FtZV9uYW1lXQ0KICAgIHByaW50KGYiXG5bT0tdIFN3aXRjaGVkIGZyb20gJ3tvbGRfZ2FtZX0nIHRvICd7Z2FtZV9uYW1lfSciKQ0KICAgIHByaW50KGYiXG5HYW1lIEluZm86IikNCiAgICBwcmludChmIiAgRGVhdGhzOiB7Z2FtZV9kZWF0aHN9IikNCiAgICBwcmludChmIiAgTW9uaXRvcjoge2dhbWVfY29uZmlnLmdldCgnbW9uaXRvcl9pbmRleCcsICdkZWZhdWx0Jyl9IikNCiAgICBwcmludChmIiAgUmVnaW9uOiB7Z2FtZV9jb25maWcuZ2V0KCdyZWdpb24nLCB7fSl9IikNCiAgICBwcmludChmIiAgS2V5d29yZHM6IHtnYW1lX2NvbmZpZy5nZXQoJ2tleXdvcmRzJywgW10pfSIpDQogICAgDQogICAgcHJpbnQoZiJcbltPS10gVGV4dCBmaWxlcyB1cGRhdGVkOiIpDQogICAgcHJpbnQoZiIgIC0ge0RFQVRIX1RYVH0gLT4ge2dhbWVfZGVhdGhzfSIpDQogICAgcHJpbnQoZiIgIC0gZGVhdGhfY291bnRlcl97Z2FtZV9uYW1lLnJlcGxhY2UoJyAnLCAnXycpfS50eHQgLT4ge2dhbWVfZGVhdGhzfSIpDQogICAgDQogICAgcHJpbnQoIlxuIiArICI9IiAqIDcwKQ0KICAgIHByaW50KCJbTk9URV0gVGhlIGRhZW1vbiB3aWxsIGNvbnRpbnVlIHJ1bm5pbmcgd2l0aCB0aGUgbmV3IGdhbWUuIikNCiAgICBwcmludCgiICAgICAgIEF1dG8tZGV0ZWN0aW9uIHdpbGwgb3ZlcnJpZGUgdGhpcyBpZiBpdCBkZXRlY3RzIGEgZGlmZmVyZW50IGdhbWUuIikNCiAgICBwcmludCgiPSIgKiA3MCkNCiAgICANCiAgICByZXR1cm4gVHJ1ZQ0KDQoNCmRlZiBtYWluKCk6DQogICAgaWYgbGVuKHN5cy5hcmd2KSA8IDI6DQogICAgICAgIHByaW50KCJVc2FnZTogcHl0aG9uIHN3aXRjaF9nYW1lX21hbnVhbC5weSBcIkdhbWUgTmFtZVwiIikNCiAgICAgICAgcHJpbnQoIlxuRXhhbXBsZXM6IikNCiAgICAgICAgcHJpbnQoJyAgcHl0aG9uIHN3aXRjaF9nYW1lX21hbnVhbC5weSAiRWxkZW4gUmluZyInKQ0KICAgICAgICBwcmludCgnICBweXRob24gc3dpdGNoX2dhbWVfbWFudWFsLnB5ICJEYXJrIFNvdWxzIDMiJykNCiAgICAgICAgcHJpbnQoJyAgcHl0aG9uIHN3aXRjaF9nYW1lX21hbnVhbC5weSAiRGFyayBTb3VscyBSZW1hc3RlcmVkIicpDQogICAgICAgIHByaW50KCcgIHB5dGhvbiBzd2l0Y2hfZ2FtZV9tYW51YWwucHkgIlNla2lybyInKQ0KICAgICAgICByZXR1cm4gMQ0KICAgIA0KICAgIGdhbWVfbmFtZSA9IHN5cy5hcmd2WzFdDQogICAgDQogICAgaWYgc3dpdGNoX2dhbWUoZ2FtZV9uYW1lKToNCiAgICAgICAgcmV0dXJuIDANCiAgICBlbHNlOg0KICAgICAgICByZXR1cm4gMQ0KDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgc3lzLmV4aXQobWFpbigpKQ0KDQo=",
  "games_config.json": "ew0KICAic2V0dGluZ3MiOiB7DQogICAgInRpY2tfc2Vjb25kcyI6IDAuMywNCiAgICAiZGVidWdfZXZlcnlfdGlja3MiOiAzMCwNCiAgICAiY29uc2VjdXRpdmVfaGl0cyI6IDIsDQogICAgImNvb2xkb3duX3NlY29uZHMiOiA1LjAsDQogICAgIm1vbml0b3JfaW5kZXgiOiAxDQogIH0sDQogICJnYW1lcyI6IHsNCiAgICAiRWxkZW4gUmluZyI6IHsNCiAgICAgICJyZWdpb24iOiB7DQogICAgICAgICJsZWZ0IjogNTIwLA0KICAgICAgICAidG9wIjogNDcwLA0KICAgICAgICAid2lkdGgiOiA4ODAsDQogICAgICAgICJoZWlnaHQiOiAyMDANCiAgICAgIH0sDQogICAgICAia2V5d29yZHMiOiBbDQogICAgICAgICJZT1VESUVEIiwNCiAgICAgICAgIllPVURJRSIsDQogICAgICAgICJZT1VERUQiLA0KICAgICAgICAiRElFRCINCiAgICAgIF0sDQogICAgICAidGVzc2VyYWN0X2NvbmZpZyI6ICItLW9lbSAzIC0tcHNtIDcgLWMgdGVzc2VkaXRfY2hhcl93aGl0ZWxpc3Q9WU9VRElFQURGVCIsDQogICAgICAibW9uaXRvcl9pbmRleCI6IDIsDQogICAgICAicHJvY2Vzc19uYW1lcyI6IFsNCiAgICAgICAgImVsZGVucmluZy5leGUiLA0KICAgICAgICAiZWxkZW4gcmluZy5leGUiDQogICAgICBdDQogICAgfSwNCiAgICAiRGFyayBTb3VscyAzIjogew0KICAgICAgInJlZ2lvbiI6IHsNCiAgICAgICAgImxlZnQiOiA1MjAsDQogICAgICAgICJ0b3AiOiA0NzAsDQogICAgICAgICJ3aWR0aCI6IDg4MCwNCiAgICAgICAgImhlaWdodCI6IDIwMA0KICAgICAgfSwNCiAgICAgICJrZXl3b3JkcyI6IFsNCiAgICAgICAgIllPVURJRUQiLA0KICAgICAgICAiWU9VRElFIiwNCiAgICAgICAgIllPVUQxRUQiLA0KICAgICAgICAiWU9VRGxFRCIsDQogICAgICAgICJZT1VESSIsDQogICAgICAgICJPVURJRUQiLA0KICAgICAgICAiWU9VRElFMCINCiAgICAgIF0sDQogICAgICAidGVzc2VyYWN0X2NvbmZpZyI6ICItLW9lbSAzIC0tcHNtIDcgLWMgdGVzc2VkaXRfY2hhcl93aGl0ZWxpc3Q9WU9VRElFQURGVCIsDQogICAgICAibW9uaXRvcl9pbmRleCI6IDIsDQogICAgICAicHJvY2Vzc19uYW1lcyI6IFsNCiAgICAgICAgImRhcmtzb3Vsc2lpaS5leGUiLA0KICAgICAgICAiZGFyayBzb3VscyBpaWkuZXhlIg0KICAgICAgXQ0KICAgIH0sDQogICAgIkRhcmsgU291bHMgUmVtYXN0ZXJlZCI6IHsNCiAgICAgICJyZWdpb24iOiB7DQogICAgICAgICJsZWZ0IjogNTIwLA0KICAgICAgICAidG9wIjogNDcwLA0KICAgICAgICAid2lkdGgiOiA4ODAsDQogICAgICAgICJoZWlnaHQiOiAyMDANCiAgICAgIH0sDQogICAgICAia2V5d29yZHMiOiBbDQogICAgICAgICJZT1VESUVEIiwNCiAgICAgICAgIllPVURJRSIsDQogICAgICAgICJZT1VEMUVEIiwNCiAgICAgICAgIllPVURsRUQiLA0KICAgICAgICAiWU9VREkiLA0KICAgICAgICAiT1VESUVEIiwNCiAgICAgICAgIllPVURJRTAiDQogICAgICBdLA0KICAgICAgInRlc3NlcmFjdF9jb25maWciOiAiLS1vZW0gMyAtLXBzbSA3IC1jIHRlc3NlZGl0X2NoYXJfd2hpdGVsaXN0PVlPVURJRUFERlQiLA0KICAgICAgIm1vbml0b3JfaW5kZXgiOiAyLA0KICAgICAgInByb2Nlc3NfbmFtZXMiOiBbDQogICAgICAgICJkYXJrc291bHNyZW1hc3RlcmVkLmV4ZSIsDQogICAgICAgICJkYXJrIHNvdWxzIHJlbWFzdGVyZWQuZXhlIg0KICAgICAgXQ0KICAgIH0sDQogICAgIkRhcmsgU291bHMgSUk6IFNjaG9sYXIgb2YgdGhlIEZpcnN0IFNpbiI6IHsNCiAgICAgICJyZWdpb24iOiB7DQogICAgICAgICJsZWZ0IjogNTIwLA0KICAgICAgICAidG9wIjogNDcwLA0KICAgICAgICAid2lkdGgiOiA4ODAsDQogICAgICAgICJoZWlnaHQiOiAyMDANCiAgICAgIH0sDQogICAgICAia2V5d29yZHMiOiBbDQogICAgICAgICJZT1VESUVEIiwNCiAgICAgICAgIllPVURJRSIsDQogICAgICAgICJZT1VEMUVEIiwNCiAgICAgICAgIllPVURsRUQiLA0KICAgICAgICAiWU9VREkiLA0KICAgICAgICAiT1VESUVEIiwNCiAgICAgICAgIllPVURJRTAiDQogICAgICBdLA0KICAgICAgInRlc3NlcmFjdF9jb25maWciOiAiLS1vZW0gMyAtLXBzbSA3IC1jIHRlc3NlZGl0X2NoYXJfd2hpdGVsaXN0PVlPVURJRUFERlQiLA0KICAgICAgIm1vbml0b3JfaW5kZXgiOiAyLA0KICAgICAgInByb2Nlc3NfbmFtZXMiOiBbDQogICAgICAgICJkYXJrc291bHNpaS5leGUiLA0KICAgICAgICAiZGFyayBzb3VscyBpaS5leGUiLA0KICAgICAgICAiZGFya3NvdWxzMi5leGUiDQogICAgICBdDQogICAgfSwNCiAgICAiU2VraXJvIjogew0KICAgICAgInJlZ2lvbiI6IHsNCiAgICAgICAgImxlZnQiOiA1MjAsDQogICAgICAgICJ0b3AiOiA0NzAsDQogICAgICAgICJ3aWR0aCI6IDg4MCwNCiAgICAgICAgImhlaWdodCI6IDIwMA0KICAgICAgfSwNCiAgICAgICJrZXl3b3JkcyI6IFsNCiAgICAgICAgIllPVURJRUQiLA0KICAgICAgICAiWU9VRElFIiwNCiAgICAgICAgIkRFQVRIIg0KICAgICAgXSwNCiAgICAgICJ0ZXNzZXJhY3RfY29uZmlnIjogIi0tb2VtIDMgLS1wc20gNyAtYyB0ZXNzZWRpdF9jaGFyX3doaXRlbGlzdD1ZT1VESUVBREZUIiwNCiAgICAgICJtb25pdG9yX2luZGV4IjogMiwNCiAgICAgICJwcm9jZXNzX25hbWVzIjogWw0KICAgICAgICAic2VraXJvLmV4ZSINCiAgICAgIF0NCiAgICB9DQogIH0sDQogICJjdXJyZW50X2dhbWUiOiAiRGFyayBTb3VscyBSZW1hc3RlcmVkIg0KfQ==",
  "START_DEATH_COUNTER.bat": "QGVjaG8gb2ZmDQpSRU0gU3RhcnQgRGVhdGggQ291bnRlciBEYWVtb24NClJFTSBUaGlzIGJhdGNoIGZpbGUgc3RhcnRzIHRoZSBkZWF0aCBjb3VudGVyIGRhZW1vbg0KUkVNIFdpbmRvdyB3aWxsIGJlIHBvc2l0aW9uZWQgaW4gdG9wIHJpZ2h0IGNvcm5lcg0KDQpjZCAvZCAiJX5kcDAiDQoNClJFTSBQb3NpdGlvbiB0aGlzIGNvbnNvbGUgd2luZG93IHRvIHRvcCByaWdodCBiZWZvcmUgc3RhcnRpbmcNCnBvd2Vyc2hlbGwgLUNvbW1hbmQgIiRob3N0LlVJLlJhd1VJLldpbmRvd1Bvc2l0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ29vcmRpbmF0ZXMgKChHZXQtSG9zdCkuVUkuUmF3VUkuQnVmZmVyU2l6ZS5XaWR0aCAtIDgwMCksIDAiDQoNCnB5dGhvbiBtdWx0aV9nYW1lX2RlYXRoX2NvdW50ZXIucHkNCg0KcGF1c2UNCg0K",
  "STOP_DEATH_COUNTER.bat": "QGVjaG8gb2ZmDQpSRU0gU3RvcCBEZWF0aCBDb3VudGVyIERhZW1vbg0KUkVNIFRoaXMgYmF0Y2ggZmlsZSBzdG9wcyB0aGUgZGVhdGggY291bnRlciBkYWVtb24gYnkgY3JlYXRpbmcgYSBTVE9QIGZpbGUNCg0KY2QgL2QgIiV+ZHAwIg0KZWNoby4gPiBTVE9QDQplY2hvIFNUT1AgZmlsZSBjcmVhdGVkLiBEYWVtb24gc2hvdWxkIHN0b3Agd2l0aGluIGEgZmV3IHNlY29uZHMuDQp0aW1lb3V0IC90IDIgL25vYnJlYWsgPm51bA0KDQppZiBleGlzdCBkYWVtb24ubG9jayAoDQogICAgZWNobyBEYWVtb24gbWF5IHN0aWxsIGJlIHJ1bm5pbmcuIENoZWNraW5nIGxvY2sgZmlsZS4uLg0KICAgIGZvciAvZiAidG9rZW5zPSoiICUlaSBpbiAoZGFlbW9uLmxvY2spIGRvICgNCiAgICAgICAgZWNobyBBdHRlbXB0aW5nIHRvIGtpbGwgcHJvY2VzcyAlJWkuLi4NCiAgICAgICAgdGFza2tpbGwgL0YgL1BJRCAlJWkgPm51bCAyPiYxDQogICAgKQ0KICAgIGRlbCBkYWVtb24ubG9jayA+bnVsIDI+JjENCiAgICBlY2hvIERhZW1vbiBzdG9wcGVkLg0KKSBlbHNlICgNCiAgICBlY2hvIERhZW1vbiBpcyBub3QgcnVubmluZy4NCikNCg0KaWYgZXhpc3QgU1RPUCBkZWwgU1RPUCA+bnVsIDI+JjENCnBhdXNlDQoNCg==",
  "install_dependencies.bat": "QGVjaG8gb2ZmDQpSRU0gSW5zdGFsbCBQeXRob24gRGVwZW5kZW5jaWVzIGZvciBEZWF0aCBDb3VudGVyDQpSRU0gVGhpcyBiYXRjaCBmaWxlIGluc3RhbGxzIGFsbCByZXF1aXJlZCBQeXRob24gcGFja2FnZXMNCg0KZWNobyBJbnN0YWxsaW5nIGRlcGVuZGVuY2llcyBmb3IgRGVhdGggQ291bnRlci4uLg0KZWNoby4NCg0KY2QgL2QgIiV+ZHAwIg0KDQpweXRob24gLW0gcGlwIGluc3RhbGwgLS11cGdyYWRlIHBpcA0KcHl0aG9uIC1tIHBpcCBpbnN0YWxsIG1zcyBwaWxsb3cgcHl0ZXNzZXJhY3Qgb3BlbmN2LXB5dGhvbiBudW1weSBwc3V0aWwNCg0KZWNoby4NCmVjaG8gSW5zdGFsbGF0aW9uIGNvbXBsZXRlIQ0KZWNoby4NCmVjaG8gTm90ZTogWW91IGFsc28gbmVlZCB0byBpbnN0YWxsIFRlc3NlcmFjdCBPQ1Igc2VwYXJhdGVseToNCmVjaG8gRG93bmxvYWQgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL1VCLU1hbm5oZWltL3Rlc3NlcmFjdC93aWtpDQplY2hvIERlZmF1bHQgcGF0aDogQzpcUHJvZ3JhbSBGaWxlc1xUZXNzZXJhY3QtT0NSXHRlc3NlcmFjdC5leGUNCmVjaG8uDQpwYXVzZQ0KDQo=",
  "README.md": "IyBNdWx0aS1HYW1lIERlYXRoIENvdW50ZXINCg0KQW4gYXV0b21hdGljIGRlYXRoIGNvdW50ZXIgdGhhdCB3b3JrcyBhY3Jvc3MgbXVsdGlwbGUgU291bHMtbGlrZSBnYW1lcyAoRWxkZW4gUmluZywgRGFyayBTb3VscywgU2VraXJvLCBldGMuKQ0KDQojIyBRdWljayBTdGFydA0KDQojIyMgMS4gSW5zdGFsbCBEZXBlbmRlbmNpZXMNCg0KKipPcHRpb24gQTogVXNlIHRoZSBiYXRjaCBmaWxlIChSZWNvbW1lbmRlZCkqKg0KYGBgDQpEb3VibGUtY2xpY2s6IGluc3RhbGxfZGVwZW5kZW5jaWVzLmJhdA0KYGBgDQoNCioqT3B0aW9uIEI6IE1hbnVhbCBpbnN0YWxsYXRpb24qKg0KYGBgYmFzaA0KcGlwIGluc3RhbGwgLXIgcmVxdWlyZW1lbnRzLnR4dA0KYGBgDQoNCiMjIyAyLiBJbnN0YWxsIFRlc3NlcmFjdCBPQ1INCg0KRG93bmxvYWQgYW5kIGluc3RhbGwgVGVzc2VyYWN0IE9DUjoNCi0gKipEb3dubG9hZDoqKiBodHRwczovL2dpdGh1Yi5jb20vVUItTWFubmhlaW0vdGVzc2VyYWN0L3dpa2kNCi0gKipEZWZhdWx0IHBhdGg6KiogYEM6XFByb2dyYW0gRmlsZXNcVGVzc2VyYWN0LU9DUlx0ZXNzZXJhY3QuZXhlYA0KLSBJZiBpbnN0YWxsZWQgZWxzZXdoZXJlLCBlZGl0IGBURVNTRVJBQ1RfRVhFYCBpbiBgbXVsdGlfZ2FtZV9kZWF0aF9jb3VudGVyLnB5YA0KDQojIyMgMy4gUnVuIHRoZSBEZWF0aCBDb3VudGVyDQoNCioqT3B0aW9uIEE6IFVzZSB0aGUgYmF0Y2ggZmlsZSAoUmVjb21tZW5kZWQpKioNCmBgYA0KRG91YmxlLWNsaWNrOiBTVEFSVF9ERUFUSF9DT1VOVEVSLmJhdA0KYGBgDQoNCioqT3B0aW9uIEI6IENvbW1hbmQgbGluZSoqDQpgYGBiYXNoDQpweXRob24gbXVsdGlfZ2FtZV9kZWF0aF9jb3VudGVyLnB5DQpgYGANCg0KKipUbyBzdG9wOioqIERvdWJsZS1jbGljayBgU1RPUF9ERUFUSF9DT1VOVEVSLmJhdGAgb3IgcHJlc3MgQ3RybCtDDQoNCiMjIEZpbGVzIE92ZXJ2aWV3DQoNCiMjIyBNYWluIEZpbGVzDQotICoqYG11bHRpX2dhbWVfZGVhdGhfY291bnRlci5weWAqKiAtIE1haW4gZGFlbW9uIHNjcmlwdCAocnVuIHRoaXMpDQotICoqYHN3aXRjaF9nYW1lLnB5YCoqIC0gVXRpbGl0eSB0byBzd2l0Y2ggYmV0d2VlbiBnYW1lcw0KLSAqKmB0ZXN0X3ByZXByb2Nlc3NpbmcucHlgKiogLSBUZXN0IHNjcmlwdCB0byB2ZXJpZnkgeW91ciBzZXR1cA0KLSAqKmByZXF1aXJlbWVudHMudHh0YCoqIC0gUHl0aG9uIGRlcGVuZGVuY2llcw0KLSAqKmBTVEFSVF9ERUFUSF9DT1VOVEVSLmJhdGAqKiAtIEVhc3kgbGF1bmNoZXINCi0gKipgU1RPUF9ERUFUSF9DT1VOVEVSLmJhdGAqKiAtIEVhc3kgc3RvcHBlcg0KLSAqKmBpbnN0YWxsX2RlcGVuZGVuY2llcy5iYXRgKiogLSBEZXBlbmRlbmN5IGluc3RhbGxlcg0KDQojIyMgU3RyZWFtZXIuYm90IEludGVncmF0aW9uIChPcHRpb25hbCkNCi0gKipgU3RyZWFtZXJCb3RfU3RhcnREZWF0aENvdW50ZXIuY3NgKiogLSBTdGFydCBkYWVtb24gZnJvbSBTdHJlYW1lci5ib3QNCi0gKipgU3RyZWFtZXJCb3RfU3RvcERlYXRoQ291bnRlci5jc2AqKiAtIFN0b3AgZGFlbW9uIGZyb20gU3RyZWFtZXIuYm90DQotICoqYFN0cmVhbWVyQm90X0dldERlYXRoQ291bnQuY3NgKiogLSBHZXQgZGVhdGggY291bnQgaW4gU3RyZWFtZXIuYm90DQotICoqYFN0cmVhbWVyQm90X1N3aXRjaEdhbWUuY3NgKiogLSBTd2l0Y2ggZ2FtZXMgZnJvbSBTdHJlYW1lci5ib3QNCg0KIyMgQ29uZmlndXJhdGlvbg0KDQojIyMgRmlyc3QgUnVuDQpPbiBmaXJzdCBydW4sIHRoZSBzY3JpcHQgY3JlYXRlczoNCi0gYEM6XGRlYXRoY291bnRlclxnYW1lc19jb25maWcuanNvbmAgLSBHYW1lIGNvbmZpZ3VyYXRpb25zDQotIGBDOlxkZWF0aGNvdW50ZXJcZGVhdGhfc3RhdGUuanNvbmAgLSBEZWF0aCBjb3VudHMgYW5kIHN0YXRlDQotIGBDOlxkZWF0aGNvdW50ZXJcZGVhdGhfY291bnRlci50eHRgIC0gVGV4dCBmaWxlIGZvciBPQlMgKHRvdGFsIGRlYXRocykNCi0gYEM6XGRlYXRoY291bnRlclxkZWJ1Zy5sb2dgIC0gTG9nIGZpbGUNCg0KIyMjIEVkaXRpbmcgR2FtZSBTZXR0aW5ncw0KDQpFZGl0IGBDOlxkZWF0aGNvdW50ZXJcZ2FtZXNfY29uZmlnLmpzb25gIHRvIGNvbmZpZ3VyZToNCg0KYGBganNvbg0Kew0KICAic2V0dGluZ3MiOiB7DQogICAgInRpY2tfc2Vjb25kcyI6IDAuMzAsDQogICAgImRlYnVnX2V2ZXJ5X3RpY2tzIjogMzAsDQogICAgImNvbnNlY3V0aXZlX2hpdHMiOiAyLA0KICAgICJjb29sZG93bl9zZWNvbmRzIjogOC4wLA0KICAgICJtb25pdG9yX2luZGV4IjogMg0KICB9LA0KICAiZ2FtZXMiOiB7DQogICAgIkVsZGVuIFJpbmciOiB7DQogICAgICAicmVnaW9uIjogeyJsZWZ0IjogNTIwLCAidG9wIjogNDcwLCAid2lkdGgiOiA4ODAsICJoZWlnaHQiOiAyMDB9LA0KICAgICAgImtleXdvcmRzIjogWyJZT1VESUVEIiwgIllPVURJRSIsICJESUVEIl0sDQogICAgICAidGVzc2VyYWN0X2NvbmZpZyI6ICItLW9lbSAzIC0tcHNtIDcgLWMgdGVzc2VkaXRfY2hhcl93aGl0ZWxpc3Q9WU9VRElFQURGVCIsDQogICAgICAibW9uaXRvcl9pbmRleCI6IDINCiAgICB9DQogIH0sDQogICJjdXJyZW50X2dhbWUiOiAiRWxkZW4gUmluZyINCn0NCmBgYA0KDQojIyMgRmluZGluZyB0aGUgUmlnaHQgUmVnaW9uIENvb3JkaW5hdGVzDQoNCjEuIFRha2UgYSBzY3JlZW5zaG90IHdoZW4gIllPVSBESUVEIiBhcHBlYXJzDQoyLiBVc2UgYW4gaW1hZ2UgZWRpdG9yIChQYWludCwgR0lNUCwgZXRjLikgdG8gZmluZCBjb29yZGluYXRlcw0KMy4gVXBkYXRlIHRoZSBgcmVnaW9uYCBpbiB0aGUgY29uZmlnOg0KICAgLSBgbGVmdGA6IFggcG9zaXRpb24gb2YgbGVmdCBlZGdlDQogICAtIGB0b3BgOiBZIHBvc2l0aW9uIG9mIHRvcCBlZGdlICANCiAgIC0gYHdpZHRoYDogV2lkdGggb2YgdGhlIHJlZ2lvbg0KICAgLSBgaGVpZ2h0YDogSGVpZ2h0IG9mIHRoZSByZWdpb24NCg0KIyMjIFN3aXRjaGluZyBHYW1lcw0KDQoqKk9wdGlvbiBBOiBFZGl0IGNvbmZpZyBmaWxlKioNCkNoYW5nZSBgImN1cnJlbnRfZ2FtZSJgIGluIGBnYW1lc19jb25maWcuanNvbmANCg0KKipPcHRpb24gQjogVXNlIHN3aXRjaCBzY3JpcHQqKg0KYGBgYmFzaA0KcHl0aG9uIHN3aXRjaF9nYW1lLnB5ICJFbGRlbiBSaW5nIg0KYGBgDQoNCiMjIE9CUyBJbnRlZ3JhdGlvbg0KDQpUaGUgZGVhdGggY291bnRlciB3cml0ZXMgdG8gdGV4dCBmaWxlcyB0aGF0IE9CUyBjYW4gcmVhZDoNCg0KLSAqKlRvdGFsIGRlYXRoczoqKiBgQzpcZGVhdGhjb3VudGVyXGRlYXRoX2NvdW50ZXIudHh0YA0KLSAqKlBlci1nYW1lIGRlYXRoczoqKiBgQzpcZGVhdGhjb3VudGVyXGRlYXRoX2NvdW50ZXJfR2FtZU5hbWUudHh0YA0KDQojIyMgT0JTIFNldHVwDQoNCjEuIEluIE9CUywgYWRkIGEgKipUZXh0IChHREkrKSoqIHNvdXJjZQ0KMi4gQ2hlY2sgKioiUmVhZCBmcm9tIGZpbGUiKioNCjMuIEJyb3dzZSB0bzogYEM6XGRlYXRoY291bnRlclxkZWF0aF9jb3VudGVyLnR4dGANCjQuIEN1c3RvbWl6ZSB0aGUgZm9udC9zdHlsZSBhcyBkZXNpcmVkDQoNCiMjIERlYnVnZ2luZw0KDQojIyMgVGVzdCBZb3VyIFNldHVwDQoNClJ1biB0aGUgdGVzdCBzY3JpcHQgdG8gdmVyaWZ5IGV2ZXJ5dGhpbmcgd29ya3M6DQpgYGBiYXNoDQpweXRob24gdGVzdF9wcmVwcm9jZXNzaW5nLnB5DQpgYGANCg0KVGhpcyB3aWxsOg0KLSBDYXB0dXJlIHRoZSBjb25maWd1cmVkIHJlZ2lvbg0KLSBTaG93IHByZXByb2Nlc3NpbmcgcmVzdWx0cw0KLSBUZXN0IE9DUiBkZXRlY3Rpb24NCi0gU2F2ZSBkZWJ1ZyBpbWFnZXMgdG8gYEM6XGRlYXRoY291bnRlclxgDQoNCiMjIyBEZWJ1ZyBJbWFnZXMNCg0KVGhlIGRhZW1vbiBzYXZlcyBkZWJ1ZyBpbWFnZXMgZXZlcnkgMzAgdGlja3MgKGRlZmF1bHQpOg0KLSBgZGVidWdfY2FwdHVyZV9yYXcucG5nYCAtIE9yaWdpbmFsIHNjcmVlbnNob3QNCi0gYGRlYnVnX2NhcHR1cmUucG5nYCAtIFByb2Nlc3NlZCBpbWFnZSAod2hhdCBPQ1Igc2VlcykNCg0KIyMjIExvZyBGaWxlDQoNCkNoZWNrIGBDOlxkZWF0aGNvdW50ZXJcZGVidWcubG9nYCBmb3IgZGV0YWlsZWQgaW5mb3JtYXRpb246DQotIE9DUiByZXN1bHRzDQotIERldGVjdGlvbiBzdGF0dXMNCi0gRGVhdGggY291bnRzDQotIEVycm9ycw0KDQojIyMgQ29tbW9uIElzc3Vlcw0KDQoqKkJsYWNrIHByb2Nlc3NlZCBpbWFnZSAoZml4ZWQhKToqKg0KLSBUaGUgbmV3IHZlcnNpb24gdXNlcyBhZGFwdGl2ZSB0aHJlc2hvbGQgZmFsbGJhY2sNCi0gU2hvdWxkIGFsd2F5cyBwcm9kdWNlIGEgdmlzaWJsZSBpbWFnZSBub3cNCi0gSWYgc3RpbGwgYmxhY2ssIGNoZWNrIHJlZ2lvbiBjb29yZGluYXRlcw0KDQoqKk5vdCBkZXRlY3RpbmcgZGVhdGhzOioqDQoxLiBDaGVjayBgZGVidWdfY2FwdHVyZV9yYXcucG5nYCAtIGlzIHRoZSByZWdpb24gY29ycmVjdD8NCjIuIENoZWNrIGBkZWJ1Z19jYXB0dXJlLnBuZ2AgLSBjYW4geW91IHNlZSB0ZXh0Pw0KMy4gVmVyaWZ5IG1vbml0b3IgaW5kZXggaXMgY29ycmVjdA0KNC4gVHJ5IGFkanVzdGluZyBrZXl3b3JkcyBpbiBjb25maWcNCg0KKipGYWxzZSBwb3NpdGl2ZXM6KioNCjEuIEluY3JlYXNlIGBjb25zZWN1dGl2ZV9oaXRzYCAocmVxdWlyZXMgbW9yZSBkZXRlY3Rpb25zKQ0KMi4gSW5jcmVhc2UgYGNvb2xkb3duX3NlY29uZHNgIChsb25nZXIgdGltZSBiZXR3ZWVuIGRlYXRocykNCg0KKipUZXNzZXJhY3QgZXJyb3JzOioqDQoxLiBWZXJpZnkgVGVzc2VyYWN0IGlzIGluc3RhbGxlZA0KMi4gQ2hlY2sgYFRFU1NFUkFDVF9FWEVgIHBhdGggaW4gdGhlIHNjcmlwdA0KMy4gRW5zdXJlIFRlc3NlcmFjdCBpcyBpbiBQQVRIDQoNCiMjIFN0cmVhbWVyLmJvdCBJbnRlZ3JhdGlvbg0KDQojIyMgU2V0dXANCg0KMS4gQ29weSB0aGUgYC5jc2AgZmlsZXMgdG8geW91ciBTdHJlYW1lci5ib3QgYWN0aW9ucyBmb2xkZXIgKG9yIHBhc3RlIGRpcmVjdGx5KQ0KMi4gQ3JlYXRlIGFjdGlvbnMgZm9yIGVhY2ggc2NyaXB0Og0KICAgLSAqKlN0YXJ0IERlYXRoIENvdW50ZXIqKiAtIFVzZXMgYFN0cmVhbWVyQm90X1N0YXJ0RGVhdGhDb3VudGVyLmNzYA0KICAgLSAqKlN0b3AgRGVhdGggQ291bnRlcioqIC0gVXNlcyBgU3RyZWFtZXJCb3RfU3RvcERlYXRoQ291bnRlci5jc2ANCiAgIC0gKipHZXQgRGVhdGggQ291bnQqKiAtIFVzZXMgYFN0cmVhbWVyQm90X0dldERlYXRoQ291bnQuY3NgIChzZXRzIHZhcmlhYmxlcykNCiAgIC0gKipTd2l0Y2ggR2FtZSoqIC0gVXNlcyBgU3RyZWFtZXJCb3RfU3dpdGNoR2FtZS5jc2ANCg0KIyMjIEltcG9ydGFudDogVXBkYXRlIFBhdGhzDQoNClRoZSBzY3JpcHQgcGF0aCBpbiBgU3RyZWFtZXJCb3RfU3RhcnREZWF0aENvdW50ZXIuY3NgIGlzIGFscmVhZHkgY29uZmlndXJlZCBmb3IgYEM6XGRlYXRoY291bnRlclxgLiANCklmIHlvdSBtb3ZlZCB0aGUgZmlsZXMgdG8gYSBkaWZmZXJlbnQgbG9jYXRpb24sIHVwZGF0ZSB0aGUgcGF0aDoNCmBgYGNzaGFycA0Kc3RyaW5nIHNjcmlwdFBhdGggPSBAIkM6XGRlYXRoY291bnRlclxtdWx0aV9nYW1lX2RlYXRoX2NvdW50ZXIucHkiOw0KYGBgDQoNCiMjIyBWYXJpYWJsZXMgU2V0IGJ5IEdldCBEZWF0aCBDb3VudA0KDQotIGBEZWF0aENvdW50VG90YWxgIC0gVG90YWwgZGVhdGhzIGFjcm9zcyBhbGwgZ2FtZXMNCi0gYERlYXRoQ291bnRHYW1lYCAtIERlYXRocyBmb3IgY3VycmVudCBnYW1lDQotIGBEZWF0aENvdW50ZXJDdXJyZW50R2FtZWAgLSBOYW1lIG9mIGN1cnJlbnQgZ2FtZQ0KDQojIyBUcm91Ymxlc2hvb3RpbmcNCg0KKipEYWVtb24gd29uJ3Qgc3RhcnQ6KioNCi0gQ2hlY2sgaWYgYW5vdGhlciBpbnN0YW5jZSBpcyBydW5uaW5nIChsb29rIGZvciBgZGFlbW9uLmxvY2tgKQ0KLSBEZWxldGUgYGRhZW1vbi5sb2NrYCBpZiBwcmV2aW91cyBpbnN0YW5jZSBjcmFzaGVkDQotIENoZWNrIGBkZWJ1Zy5sb2dgIGZvciBlcnJvcnMNCg0KKipEZWF0aHMgbm90IGNvdW50aW5nOioqDQotIFZlcmlmeSByZWdpb24gY2FwdHVyZXMgIllPVSBESUVEIiB0ZXh0DQotIENoZWNrIGRlYnVnIGltYWdlcw0KLSBMb3dlciBgY29uc2VjdXRpdmVfaGl0c2AgaWYgZGV0ZWN0aW9uIGlzIGluY29uc2lzdGVudA0KLSBWZXJpZnkga2V5d29yZHMgbWF0Y2ggT0NSIG91dHB1dA0KDQoqKkhpZ2ggQ1BVIHVzYWdlOioqDQotIEluY3JlYXNlIGB0aWNrX3NlY29uZHNgIChzbG93ZXIgY2hlY2tpbmcgPSBsb3dlciBDUFUpDQotIFJlZHVjZSBgZGVidWdfZXZlcnlfdGlja3NgIChsZXNzIGZyZXF1ZW50IGltYWdlIHNhdmluZykNCg0KIyMgQWRkaW5nIE5ldyBHYW1lcw0KDQoxLiBBZGQgZW50cnkgdG8gYGdhbWVzYCBpbiBgZ2FtZXNfY29uZmlnLmpzb25gOg0KYGBganNvbg0KIllvdXIgR2FtZSBOYW1lIjogew0KICAicmVnaW9uIjogeyJsZWZ0IjogWCwgInRvcCI6IFksICJ3aWR0aCI6IFcsICJoZWlnaHQiOiBIfSwNCiAgImtleXdvcmRzIjogWyJLRVlXT1JEMSIsICJLRVlXT1JEMiJdLA0KICAidGVzc2VyYWN0X2NvbmZpZyI6ICItLW9lbSAzIC0tcHNtIDciLA0KICAibW9uaXRvcl9pbmRleCI6IDENCn0NCmBgYA0KDQoyLiBTd2l0Y2ggdG8gdGhlIG5ldyBnYW1lIHVzaW5nIGBzd2l0Y2hfZ2FtZS5weWAgb3IgZWRpdCBjb25maWcNCg0KIyMgU3VwcG9ydA0KDQpNb3N0IGlzc3VlcyBjYW4gYmUgcmVzb2x2ZWQgYnk6DQoxLiBDaGVja2luZyBkZWJ1ZyBpbWFnZXMgKGBkZWJ1Z19jYXB0dXJlX3Jhdy5wbmdgIGFuZCBgZGVidWdfY2FwdHVyZS5wbmdgKQ0KMi4gUmV2aWV3aW5nIGBkZWJ1Zy5sb2dgIGZvciBlcnJvciBtZXNzYWdlcw0KMy4gVmVyaWZ5aW5nIHJlZ2lvbiBjb29yZGluYXRlcyBhbmQgbW9uaXRvciBpbmRleA0KNC4gQWRqdXN0aW5nIGRldGVjdGlvbiBwYXJhbWV0ZXJzIGluIGNvbmZpZw0KDQpUaGUgbmV3IHZlcnNpb24gZml4ZXMgdGhlICJibGFjayBpbWFnZSIgaXNzdWUgYnkgdXNpbmcgcm9idXN0IHByZXByb2Nlc3Npbmcgd2l0aCBhZGFwdGl2ZSB0aHJlc2hvbGQgZmFsbGJhY2suDQoNCg=="
}

INSTALL_DIR = r"C:\1deathcounter"

def extract_files():
    """Extract all embedded files."""
    extracted = []
    os.makedirs(INSTALL_DIR, exist_ok=True)
    
    for filename, content_b64 in EMBEDDED_FILES.items():
        try:
            content = base64.b64decode(content_b64)
            filepath = os.path.join(INSTALL_DIR, filename)
            
            # Write file
            with open(filepath, 'wb') as f:
                f.write(content)
            
            extracted.append(filepath)
            print(f"Extracted: {filename}")
        except Exception as e:
            print(f"Error extracting {filename}: {e}")
    
    return extracted

def find_python_in_common_locations():
    """Find Python executable in common installation locations."""
    # First, try commands in PATH
    for python_name in ['python', 'python3', 'py']:
        try:
            result = subprocess.run([python_name, '--version'], 
                                  capture_output=True, text=True, timeout=2)
            if result.returncode == 0:
                # Verify it can actually run Python code
                test_result = subprocess.run([python_name, '-c', 'import sys; print(sys.version)'],
                                            capture_output=True, text=True, timeout=2)
                if test_result.returncode == 0:
                    return python_name, result.stdout.strip()
        except:
            continue
    
    # If not in PATH, check common installation locations
    common_paths = [
        r"C:\Python312\python.exe",
        r"C:\Python311\python.exe",
        r"C:\Python310\python.exe",
        r"C:\Python39\python.exe",
        r"C:\Python38\python.exe",
        r"C:\Program Files\Python312\python.exe",
        r"C:\Program Files\Python311\python.exe",
        r"C:\Program Files\Python310\python.exe",
        r"C:\Program Files\Python39\python.exe",
        r"C:\Program Files\Python38\python.exe",
        r"C:\Program Files (x86)\Python312\python.exe",
        r"C:\Program Files (x86)\Python311\python.exe",
        r"C:\Program Files (x86)\Python310\python.exe",
        os.path.expanduser(r"~\AppData\Local\Programs\Python\Python312\python.exe"),
        os.path.expanduser(r"~\AppData\Local\Programs\Python\Python311\python.exe"),
        os.path.expanduser(r"~\AppData\Local\Programs\Python\Python310\python.exe"),
        os.path.expanduser(r"~\AppData\Local\Programs\Python\Python39\python.exe"),
        os.path.expanduser(r"~\AppData\Local\Programs\Python\Python38\python.exe"),
    ]
    
    for python_path in common_paths:
        if os.path.exists(python_path):
            try:
                result = subprocess.run([python_path, '--version'], 
                                      capture_output=True, text=True, timeout=2)
                if result.returncode == 0:
                    return python_path, result.stdout.strip()
            except:
                continue
    
    return None, None

def check_python():
    """Check if Python is installed."""
    # If running as a PyInstaller exe, we need to find Python for running scripts
    if getattr(sys, 'frozen', False):
        # Running as compiled exe - check if Python is available for running scripts
        python_cmd, version = find_python_in_common_locations()
        if python_cmd:
            return True, version
        return False, None
    
    # Running as script - check if Python is available
    try:
        result = subprocess.run([sys.executable, '--version'], 
                              capture_output=True, text=True, timeout=5)
        return True, result.stdout.strip()
    except:
        # Try to find Python in PATH
        python_cmd, version = find_python_in_common_locations()
        if python_cmd:
            return True, version
        return False, None

def check_tesseract():
    """Check if Tesseract OCR is installed."""
    default_path = r"C:\Program Files\Tesseract-OCR\tesseract.exe"
    if os.path.exists(default_path):
        return True, default_path
    try:
        result = subprocess.run(['tesseract', '--version'], 
                              capture_output=True, text=True, timeout=5)
        if result.returncode == 0:
            return True, "tesseract"
    except:
        pass
    return False, None

def download_file(url, filepath, log_callback=None):
    """Download a file from URL to filepath with progress."""
    try:
        if log_callback:
            log_callback(f"Downloading from {url}...")
        
        def show_progress(block_num, block_size, total_size):
            if total_size > 0:
                percent = min(100, (block_num * block_size * 100) // total_size)
                if log_callback and block_num % 10 == 0:  # Update every 10 blocks
                    log_callback(f"Download progress: {percent}%")
        
        urllib.request.urlretrieve(url, filepath, show_progress)
        if log_callback:
            log_callback(f"Download complete: {os.path.basename(filepath)}")
        return True
    except Exception as e:
        if log_callback:
            log_callback(f"Download error: {e}")
        return False

def install_python(log_callback=None):
    """Install Python by opening download page or downloading installer."""
    python_url = "https://www.python.org/downloads/"
    
    if log_callback:
        log_callback("Python not found. Opening download page...")
    
    # Open Python download page in browser
    try:
        webbrowser.open(python_url)
        if log_callback:
            log_callback("Please download and install Python from the opened page.")
            log_callback("After installation, restart this installer.")
        return False  # Not automatically installed, user needs to do it
    except Exception as e:
        if log_callback:
            log_callback(f"Could not open browser: {e}")
            log_callback(f"Please visit: {python_url}")
        return False

def install_tesseract(log_callback=None):
    """Install Tesseract OCR by opening download page."""
    tesseract_url = "https://github.com/UB-Mannheim/tesseract/wiki"
    
    if log_callback:
        log_callback("Tesseract OCR not found. Opening download page...")
    
    # Open Tesseract download page in browser
    try:
        webbrowser.open(tesseract_url)
        if log_callback:
            log_callback("Please download and install Tesseract OCR from the opened page.")
            log_callback("Default install path: C:\\Program Files\\Tesseract-OCR\\")
        return False  # Not automatically installed, user needs to do it
    except Exception as e:
        if log_callback:
            log_callback(f"Could not open browser: {e}")
            log_callback(f"Please visit: {tesseract_url}")
        return False

def install_dependencies():
    """Install Python dependencies."""
    try:
        packages = ['mss', 'pillow', 'pytesseract', 'opencv-python', 'numpy', 'psutil']
        
        # Find Python executable
        if getattr(sys, 'frozen', False):
            python_cmd, _ = find_python_in_common_locations()
            if not python_cmd:
                return False
        else:
            python_cmd = sys.executable
        
        subprocess.run([python_cmd, '-m', 'pip', 'install', '--upgrade', 'pip'], 
                      check=False, capture_output=True)
        subprocess.run([python_cmd, '-m', 'pip', 'install'] + packages, 
                      check=True, capture_output=True)
        return True
    except subprocess.CalledProcessError as e:
        return False

class InstallerGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("Death Counter - Installer & Launcher")
        self.root.geometry("650x620")
        self.root.resizable(False, False)
        
        # Configure root window to expand
        self.root.columnconfigure(0, weight=1)
        self.root.rowconfigure(0, weight=1)
        
        self.setup_complete = False
        self.create_ui()
        self.check_system()
    
    def create_ui(self):
        main_frame = ttk.Frame(self.root, padding="20")
        main_frame.grid(row=0, column=0, sticky=(tk.W, tk.E, tk.N, tk.S))
        
        title = ttk.Label(main_frame, text="Death Counter", 
                         font=("Arial", 18, "bold"))
        title.grid(row=0, column=0, columnspan=2, pady=(0, 20))
        
        status_frame = ttk.LabelFrame(main_frame, text="System Check", padding="10")
        status_frame.grid(row=1, column=0, columnspan=2, sticky=(tk.W, tk.E), pady=(0, 10))
        
        self.python_status = ttk.Label(status_frame, text="Checking Python...")
        self.python_status.grid(row=0, column=0, sticky=tk.W, pady=2)
        
        self.tesseract_status = ttk.Label(status_frame, text="Checking Tesseract OCR...")
        self.tesseract_status.grid(row=1, column=0, sticky=tk.W, pady=2)
        
        self.deps_status = ttk.Label(status_frame, text="Checking dependencies...")
        self.deps_status.grid(row=2, column=0, sticky=tk.W, pady=2)
        
        log_frame = ttk.LabelFrame(main_frame, text="Log", padding="10")
        log_frame.grid(row=2, column=0, columnspan=2, sticky=(tk.W, tk.E, tk.N, tk.S), pady=(0, 10))
        main_frame.rowconfigure(2, weight=1)
        
        self.log_text = scrolledtext.ScrolledText(log_frame, height=10, width=60)
        self.log_text.pack(fill=tk.BOTH, expand=True)
        
        button_frame = ttk.Frame(main_frame)
        button_frame.grid(row=3, column=0, columnspan=2, pady=(0, 10))
        
        self.install_button = ttk.Button(button_frame, text="Install/Update Files", 
                                         command=self.install_files, width=20)
        self.install_button.pack(side=tk.LEFT, padx=5)
        
        self.install_python_button = ttk.Button(button_frame, text="Install Python", 
                                               command=self.install_python_click, width=18)
        self.install_python_button.pack(side=tk.LEFT, padx=2)
        
        self.install_tesseract_button = ttk.Button(button_frame, text="Install Tesseract", 
                                                   command=self.install_tesseract_click, width=18)
        self.install_tesseract_button.pack(side=tk.LEFT, padx=2)
        
        button_frame2 = ttk.Frame(main_frame)
        button_frame2.grid(row=4, column=0, columnspan=2, pady=(0, 10))
        
        self.install_deps_button = ttk.Button(button_frame2, text="Install Dependencies", 
                                              command=self.install_deps, width=20)
        self.install_deps_button.pack(side=tk.LEFT, padx=5)
        
        self.launch_button = ttk.Button(button_frame2, text="Launch Death Counter", 
                                       command=self.launch_app, width=20, state=tk.DISABLED)
        self.launch_button.pack(side=tk.LEFT, padx=5)
        
        info_text = ("1. Click 'Install/Update Files' to extract all files\n"
                    "2. If Python is missing, click 'Install Python' (opens download page)\n"
                    "3. If Tesseract is missing, click 'Install Tesseract' (opens download page)\n"
                    "4. Click 'Install Dependencies' to install Python packages\n"
                    "5. Click 'Launch Death Counter' to start")
        info_label = ttk.Label(main_frame, text=info_text, justify=tk.LEFT)
        info_label.grid(row=5, column=0, columnspan=2, sticky=tk.W, pady=(0, 10))
        
        # Configure main_frame to properly expand
        main_frame.columnconfigure(0, weight=1)
        self.root.update_idletasks()  # Update to get proper sizing
    
    def log(self, message):
        self.log_text.insert(tk.END, message + "\n")
        self.log_text.see(tk.END)
        self.root.update()
    
    def check_system(self):
        python_ok, python_version = check_python()
        if python_ok:
            self.python_status.config(text=f" Python: {python_version}", foreground="green")
            self.install_python_button.config(state=tk.DISABLED)
        else:
            self.python_status.config(text=" Python not found - Click 'Install Python' button", foreground="red")
            self.install_python_button.config(state=tk.NORMAL)
        
        tesseract_ok, tesseract_path = check_tesseract()
        if tesseract_ok:
            self.tesseract_status.config(text=" Tesseract OCR: Found", foreground="green")
            self.install_tesseract_button.config(state=tk.DISABLED)
        else:
            self.tesseract_status.config(text=" Tesseract OCR: Not found - Click 'Install Tesseract' button", foreground="orange")
            self.install_tesseract_button.config(state=tk.NORMAL)
        
        try:
            import mss
            import cv2
            import pytesseract
            import psutil
            self.deps_status.config(text=" Dependencies: Installed", foreground="green")
        except ImportError:
            self.deps_status.config(text=" Dependencies: Not installed", foreground="red")
        
        # Check for both possible GUI filenames
        gui_path = os.path.join(INSTALL_DIR, "death_counter_gui.py")
        gui_path_alt = os.path.join(INSTALL_DIR, "1death_counter_gui.py")
        if os.path.exists(gui_path) or os.path.exists(gui_path_alt):
            self.setup_complete = True
            self.launch_button.config(state=tk.NORMAL)
            self.log("Files already installed. Ready to launch!")
        else:
            self.log("Files not yet installed. Click 'Install/Update Files' first.")
    
    def install_files(self):
        self.log("Installing files...")
        self.install_button.config(state=tk.DISABLED)
        
        def do_install():
            try:
                extracted = extract_files()
                self.log(f"Extracted {len(extracted)} files successfully!")
                self.setup_complete = True
                self.launch_button.config(state=tk.NORMAL)
            except Exception as e:
                self.log(f"Error installing files: {e}")
                messagebox.showerror("Error", f"Failed to install files: {e}")
            finally:
                self.install_button.config(state=tk.NORMAL)
        
        threading.Thread(target=do_install, daemon=True).start()
    
    def install_deps(self):
        self.log("Installing dependencies...")
        self.install_deps_button.config(state=tk.DISABLED)
        
        def do_install():
            try:
                if install_dependencies():
                    self.log("Dependencies installed successfully!")
                    self.check_system()
                else:
                    self.log("Failed to install dependencies.")
                    messagebox.showerror("Error", "Failed to install dependencies.")
            except Exception as e:
                self.log(f"Error: {e}")
                messagebox.showerror("Error", f"Failed to install dependencies: {e}")
            finally:
                self.install_deps_button.config(state=tk.NORMAL)
        
        threading.Thread(target=do_install, daemon=True).start()
    
    def install_python_click(self):
        """Handle Install Python button click."""
        self.log("Checking Python installation...")
        python_ok, _ = check_python()
        if python_ok:
            self.log("Python is already installed!")
            messagebox.showinfo("Python Found", "Python is already installed on your system.")
            self.check_system()
            return
        
        self.log("Python not found. Opening download page...")
        result = messagebox.askyesno(
            "Install Python",
            "Python is not installed.\n\n"
            "This will open the Python download page in your browser.\n"
            "After downloading and installing Python:\n"
            "1. Make sure to check 'Add Python to PATH' during installation\n"
            "2. Restart this installer\n\n"
            "Open download page now?",
            icon='question'
        )
        
        if result:
            install_python(self.log)
            messagebox.showinfo(
                "Python Installation",
                "Please download and install Python from the opened page.\n\n"
                "IMPORTANT: Check 'Add Python to PATH' during installation!\n\n"
                "After installation, close and restart this installer."
            )
    
    def install_tesseract_click(self):
        """Handle Install Tesseract button click."""
        self.log("Checking Tesseract OCR installation...")
        tesseract_ok, _ = check_tesseract()
        if tesseract_ok:
            self.log("Tesseract OCR is already installed!")
            messagebox.showinfo("Tesseract Found", "Tesseract OCR is already installed on your system.")
            self.check_system()
            return
        
        self.log("Tesseract OCR not found. Opening download page...")
        result = messagebox.askyesno(
            "Install Tesseract OCR",
            "Tesseract OCR is not installed.\n\n"
            "This will open the Tesseract download page in your browser.\n"
            "After downloading and installing Tesseract:\n"
            "1. Install to default path: C:\\Program Files\\Tesseract-OCR\\\n"
            "2. Restart this installer\n\n"
            "Open download page now?",
            icon='question'
        )
        
        if result:
            install_tesseract(self.log)
            messagebox.showinfo(
                "Tesseract Installation",
                "Please download and install Tesseract OCR from the opened page.\n\n"
                "Default install path: C:\\Program Files\\Tesseract-OCR\\\n\n"
                "After installation, close and restart this installer."
            )
    
    def find_python_executable(self):
        """Find Python executable, checking PATH and common installation locations."""
        python_cmd, version = find_python_in_common_locations()
        if python_cmd:
            self.log(f"Found Python: {python_cmd} ({version})")
        return python_cmd
    
    def launch_app(self):
        # Try both possible GUI filenames (with and without "1" prefix)
        gui_path = os.path.join(INSTALL_DIR, "death_counter_gui.py")
        gui_path_alt = os.path.join(INSTALL_DIR, "1death_counter_gui.py")
        
        if os.path.exists(gui_path_alt):
            gui_path = gui_path_alt
        elif not os.path.exists(gui_path):
            messagebox.showerror("Error", "Death Counter GUI not found. Please install files first.")
            return
        
        try:
            # If running as exe, we need to find Python to run the script
            if getattr(sys, 'frozen', False):
                # Running as compiled exe - try to find Python
                self.log("Searching for Python executable...")
                python_cmd = self.find_python_executable()
                
                if python_cmd:
                    self.log(f"Launching with: {python_cmd} {gui_path}")
                    subprocess.Popen([python_cmd, gui_path], 
                                   cwd=INSTALL_DIR,
                                   creationflags=subprocess.CREATE_NO_WINDOW if hasattr(subprocess, 'CREATE_NO_WINDOW') else 0)
                    self.log("Death Counter launched!")
                    messagebox.showinfo("Success", "Death Counter GUI launched!")
                else:
                    self.log("Error: Python not found in PATH or common locations")
                    result = messagebox.askyesno(
                        "Python Not Found",
                        "Python was not found on your system.\n\n"
                        "The Death Counter requires Python to run.\n\n"
                        "Would you like to:\n"
                        "1. Open the Python download page to install it?\n"
                        "2. Or check if Python is installed but not in PATH?\n\n"
                        "Open download page now?",
                        icon='warning'
                    )
                    if result:
                        install_python(self.log)
                        messagebox.showinfo(
                            "Python Installation",
                            "Please download and install Python.\n\n"
                            "IMPORTANT: Check 'Add Python to PATH' during installation!\n\n"
                            "After installation, restart this installer and try again."
                        )
                    return
            else:
                # Running as script - use sys.executable
                subprocess.Popen([sys.executable, gui_path], 
                               cwd=INSTALL_DIR,
                               creationflags=subprocess.CREATE_NO_WINDOW if hasattr(subprocess, 'CREATE_NO_WINDOW') else 0)
                self.log("Death Counter launched!")
                messagebox.showinfo("Success", "Death Counter GUI launched!")
        except Exception as e:
            self.log(f"Error launching: {e}")
            messagebox.showerror("Error", f"Failed to launch: {e}\n\nCheck the log for details.")

def main():
    root = tk.Tk()
    app = InstallerGUI(root)
    root.mainloop()

if __name__ == "__main__":
    main()
